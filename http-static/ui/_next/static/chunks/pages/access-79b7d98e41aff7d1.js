(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{9638:function(e,t,s){"use strict";s.d(t,{i:function(){return O}});var n=s(5721),r=s(6360),i=s(3497),o=Object.defineProperty,a=Object.defineProperties,c=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,h=(e,t,s)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,p=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&h(e,s,t[s]);if(d)for(var s of d(t))u.call(t,s)&&h(e,s,t[s]);return e},g=(e,t)=>a(e,c(t)),f=(0,i.k)((e,{captionSide:t,horizontalSpacing:s,verticalSpacing:n,fontSize:r,withBorder:i,withColumnBorders:o})=>{let a=`1px solid ${"dark"===e.colorScheme?e.colors.dark[4]:e.colors.gray[3]}`;return{root:g(p({},e.fn.fontStyles()),{width:"100%",borderCollapse:"collapse",captionSide:t,color:"dark"===e.colorScheme?e.colors.dark[0]:e.black,lineHeight:e.lineHeight,border:i?a:"","& caption":{marginTop:"top"===t?0:e.spacing.xs,marginBottom:"bottom"===t?0:e.spacing.xs,fontSize:e.fontSizes.sm,color:"dark"===e.colorScheme?e.colors.dark[2]:e.colors.gray[6]},"& thead tr th, & tfoot tr th":{textAlign:"left",fontWeight:"bold",color:"dark"===e.colorScheme?e.colors.dark[0]:e.colors.gray[7],fontSize:e.fn.size({size:r,sizes:e.fontSizes}),padding:`${e.fn.size({size:n,sizes:e.spacing})}px ${e.fn.size({size:s,sizes:e.spacing})}px`},"& thead tr th":{borderBottom:a},"& tfoot tr th":{borderTop:a},"& tbody tr td":{padding:`${e.fn.size({size:n,sizes:e.spacing})}px ${e.fn.size({size:s,sizes:e.spacing})}px`,borderTop:a,fontSize:e.fn.size({size:r,sizes:e.fontSizes})},"& tbody tr:first-of-type td":{borderTop:"none"},"& thead th, & tbody td":{borderRight:o?a:"none","&:last-of-type":{borderRight:"none",borderLeft:o?a:"none"}},"&[data-striped] tbody tr:nth-of-type(odd)":{backgroundColor:"dark"===e.colorScheme?e.colors.dark[6]:e.colors.gray[0]},"&[data-hover] tbody tr":e.fn.hover({backgroundColor:"dark"===e.colorScheme?e.colors.dark[5]:e.colors.gray[1]})})}}),m=s(5992),b=Object.defineProperty,x=Object.defineProperties,j=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,S=(e,t,s)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,k=(e,t)=>{for(var s in t||(t={}))y.call(t,s)&&S(e,s,t[s]);if(v)for(var s of v(t))w.call(t,s)&&S(e,s,t[s]);return e},A=(e,t)=>x(e,j(t)),M=(e,t)=>{var s={};for(var n in e)y.call(e,n)&&0>t.indexOf(n)&&(s[n]=e[n]);if(null!=e&&v)for(var n of v(e))0>t.indexOf(n)&&w.call(e,n)&&(s[n]=e[n]);return s};let C={striped:!1,highlightOnHover:!1,captionSide:"top",horizontalSpacing:"xs",fontSize:"sm",verticalSpacing:7,withBorder:!1,withColumnBorders:!1},O=(0,n.forwardRef)((e,t)=>{let s=(0,r.N4)("Table",C,e),{className:i,children:o,striped:a,highlightOnHover:c,captionSide:d,horizontalSpacing:l,verticalSpacing:u,fontSize:h,unstyled:p,withBorder:g,withColumnBorders:b}=s,x=M(s,["className","children","striped","highlightOnHover","captionSide","horizontalSpacing","verticalSpacing","fontSize","unstyled","withBorder","withColumnBorders"]),{classes:j,cx:v}=f({captionSide:d,verticalSpacing:u,horizontalSpacing:l,fontSize:h,withBorder:g,withColumnBorders:b},{unstyled:p,name:"Table"});return n.createElement(m.x,A(k({},x),{component:"table",ref:t,className:v(j.root,i),"data-striped":a||void 0,"data-hover":c||void 0}),o)});O.displayName="@mantine/core/Table"},9454:function(e,t,s){"use strict";function n(e,t){if("number"==typeof e)return t.length===e;let{max:s,min:n}=e,r=!0;return"number"==typeof s&&t.length>s&&(r=!1),"number"==typeof n&&t.length<n&&(r=!1),r}function r(e,t){let s=t||!0;return t=>"string"==typeof t?n(e,t.trim())?null:s:"object"==typeof t&&null!==t&&"length"in t&&n(e,t)?null:s}s.d(t,{d:function(){return r}})},6080:function(e,t,s){"use strict";function n(e,t){let s=t||!0;return t=>"string"!=typeof t?s:e.test(t)?null:s}s.d(t,{w:function(){return n}})},641:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var n=(0,s(2516).Z)("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]])},7328:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var n=(0,s(2516).Z)("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]])},3285:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/access",function(){return s(4480)}])},90:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var n=s(6521),r=s(2715),i=s(3685),o=s(5988),a=s(5039),c=s(9128),d=s(5721);function l(e){let{children:t}=e,[s,l]=(0,d.useState)(!1);return(0,n.jsx)(t.type,{...Object.fromEntries(Object.entries(t.props)),labelProps:{display:"block"},label:(0,n.jsxs)(r.Z,{mb:"4px",spacing:5,children:[t.props.label,(0,n.jsx)(i.x,{children:(t.props.withAsterisk||t.props.required)&&(0,n.jsx)(i.x,{span:!0,color:"red","aria-hidden":!0,children:" *"})}),(0,n.jsx)(i.x,{ml:"auto",color:"gray.6",sx:{cursor:"pointer"},onClick:e=>{l(!s),e.preventDefault()},children:(0,n.jsx)(o.M,{children:(0,n.jsx)(c.Z,{size:14,stroke:1.5})})})]}),description:(0,n.jsx)(a.U,{in:s,transitionDuration:100,children:(0,n.jsx)(i.x,{size:"xs",color:"gray.6",lh:"14px",children:t.props.description})}),withAsterisk:!1})}},4153:function(e,t,s){"use strict";s.d(t,{Z:function(){return f}});var n=s(6521),r=s(5721),i=s(5384),o=s(3790),a=s(9626),c=s(2715),d=s(8349),l=s(3685),u=s(7591),h=s(5992),p=s(7663);function g(e){let t="connected"===e.status?"green":"warn"===e.status?"orange":"disconnected"===e.status?"red":"gray";return(0,n.jsx)(o.X,{h:"100%",withBorder:!0,children:(0,n.jsxs)(a.K,{spacing:0,h:"100%",children:[(0,n.jsxs)(c.Z,{position:"apart",align:"center",p:"xs",sx:e=>({borderBottom:"1px solid ".concat(e.colors.gray[3])}),children:[(0,n.jsxs)(c.Z,{spacing:"xs",noWrap:!0,children:[(0,n.jsx)(d.k,{color:t,variant:"light",children:e.icon}),(0,n.jsx)(l.x,{weight:500,c:t,transform:"uppercase",children:e.name}),e.addEl&&"string"==typeof e.addEl?(0,n.jsx)(l.x,{c:"dimmed",size:"sm",children:e.addEl}):e.addEl]}),(0,n.jsxs)(c.Z,{spacing:"xs",noWrap:!0,children:[e.addElRight,e.settingsAction&&(0,n.jsx)(u.A,{color:"blue",onClick:e.settingsAction,children:(0,n.jsx)(p.Z,{size:18})})]})]}),(0,n.jsx)(h.x,{bg:e.bg,h:"100%",children:e.children})]})})}function f(e){let[t,s]=(0,r.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{...e.settings,opened:t,setOpened:s}),(0,n.jsx)(g,{...e,settingsAction:()=>s(!0),children:e.children})]})}},124:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var n=s(6521),r=s(139),i=s(9626),o=s(3685),a=s(2715),c=s(9400),d=s(5721);function l(e){let{children:t,title:s,description:l,buttonText:u}=e,[h,p]=(0,d.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.u,{opened:h,onClose:()=>p(!1),withCloseButton:!1,children:(0,n.jsxs)(i.K,{children:[(0,n.jsx)(o.x,{fz:"md",weight:500,align:"center",children:s}),(0,n.jsx)(o.x,{fz:"sm",c:"gray.7",align:"center",children:l}),(0,n.jsxs)(a.Z,{position:"center",children:[(0,n.jsx)(c.z,{color:"orange",onClick:()=>{t.props.onClick(),p(!1)},children:u}),(0,n.jsx)(c.z,{color:"green",onClick:()=>p(!1),children:"Cancel"})]})]})}),(0,n.jsx)(t.type,{...t.props,onClick:()=>p(!0)})]})}},15:function(e,t,s){"use strict";s.d(t,{M:function(){return a},u:function(){return c}});var n=s(6521),r=s(2766),i=s(9445),o=s(8342);async function a(e){(0,r.yK)("settings-save"),(0,r.c0)({id:"settings-save",disallowClose:!0,autoClose:!1,loading:!0,icon:null,color:"orange",title:"Saving settings...",message:"Please wait while the new settings are applied..."});try{await e()}catch(e){(0,r.wD)({id:"settings-save",loading:!1,disallowClose:!1,color:"red",icon:(0,n.jsx)(i.Z,{}),title:"Error saving settings",message:"There was an error saving settings. Please check form data and try again."}),console.error(e);return}(0,r.wD)({id:"settings-save",loading:!1,disallowClose:!1,autoClose:1e3,color:"green",icon:(0,n.jsx)(o.Z,{}),title:"Settings saved",message:"Settings were saved and applied successfully."})}function c(e,t,s){return function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input";return function(e,t,s,n){let r=e.getInputProps(t,s);return{...r,classNames:{input:e.isDirty(t)&&n||void 0}}}(e,n,{...s,type:r},t)}}},6485:function(e,t,s){"use strict";function n(e){return e?e.toString().match(o)?void 0:"Invalid IP address.":"Required."}function r(e,t){return(s,n)=>e(n)?t(s):void 0}s.d(t,{C6:function(){return i},Cl:function(){return n},Sg:function(){return r}});let i=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,o=/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/},4480:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return et}});var n=s(6521),r=s(5721),i=s(9400),o=s(9638),a=s(5295),c=s(3685),d=s(9626),l=s(7591),u=s(2715),h=s(5152),p=s(7563),g=s(4984),f=s(641),m=(0,s(2516).Z)("password","IconPassword",[["path",{d:"M12 10v4",key:"svg-0"}],["path",{d:"M10 13l4 -2",key:"svg-1"}],["path",{d:"M10 11l4 2",key:"svg-2"}],["path",{d:"M5 10v4",key:"svg-3"}],["path",{d:"M3 13l4 -2",key:"svg-4"}],["path",{d:"M3 11l4 2",key:"svg-5"}],["path",{d:"M19 10v4",key:"svg-6"}],["path",{d:"M17 13l4 -2",key:"svg-7"}],["path",{d:"M17 11l4 2",key:"svg-8"}]]),b=s(7328),x=s(5619),j=s.n(x),v=s(9994),y=s(6765),w=s(7023),S=s(9056),k=s(90);function A(e){let{initialValues:t,onSubmit:s,saving:r}=e,i=(0,y.c)({initialValues:t,validate:{modbus:{sessionTtl:(0,w.m)({min:0,max:525600},"Must be in range 0-525600. 0 - unlimited."),modbusAuthErrorCode:(0,w.m)({min:1,max:255},"Must be in range 1-255.")}}});return(0,n.jsx)("form",{onSubmit:i.onSubmit(s),children:(0,n.jsxs)(d.K,{children:[(0,n.jsx)(k.Z,{children:(0,n.jsx)(v.Y,{label:"Session TTL (seconds):",description:"Period of idleness (in seconds) after which the Modbus authenticated session will be expired. 0 - unlimited.",required:!0,...i.getInputProps("modbus.sessionTtl")})}),(0,n.jsx)(k.Z,{children:(0,n.jsx)(v.Y,{label:"Modbus error on insufficient access rights (decimal):",description:"The code of Modbus error that will be returned to the client if the client has no access rights to the requested data. Default value: 10 (0x0A)",required:!0,...i.getInputProps("modbus.modbusAuthErrorCode")})}),(0,n.jsx)(S.Z,{type:"submit",inProgress:r,children:"Save"})]})})}var M=s(15),C=s(4153),O=s(124),z=s(4893),P=s(1904);async function Z(e){let t=(0,z.bH)();return await (0,z.ri)(t,"/api/user/".concat(e.username,"/update/"),{method:"POST",body:JSON.stringify({allowModbus:e.allowModbus,allowApi:e.allowApi,level:e.level})}),(0,P.ph)(["/api/users/",t])}async function T(e,t){let s=(0,z.bH)();await (0,z.ri)(s,"/api/user/".concat(e,"/change-password/"),{method:"POST",body:JSON.stringify({password:t})})}async function D(e,t){let s=(0,z.bH)();await (0,z.ri)(s,"/api/users/create/",{method:"POST",body:JSON.stringify({username:e,password:t})})}async function I(e){let t=(0,z.bH)();return await (0,z.ri)(t,"/api/user/".concat(e,"/remove/"),{method:"POST",body:JSON.stringify({})}),(0,P.ph)(["/api/users/",t])}async function E(e){let t=(0,z.bH)();await (0,z.ri)(t,"/api/modbus/free-ranges/create/",{method:"POST",body:JSON.stringify(e)})}async function N(e){let t=(0,z.bH)(),s=e.device;return await (0,z.ri)(t,"/api/modbus/free-range/".concat(void 0===s?"null":s,"-").concat(e.function,"/").concat(e.range,"/remove/"),{method:"POST",body:JSON.stringify({})}),(0,P.ph)(["/api/modbus/free-ranges/",t])}async function B(e){let[t,s]=e,n=await (0,P.wv)(s,["auth:defaultModbusAccess:configurationAccess","auth:defaultModbusAccess:modbusDevicesAccess","auth:modbusAuthErrorCode","auth:sessionTtl"]);return{modbus:{defaultAccess:{configuration:n["auth:defaultModbusAccess:configurationAccess"],connectedDevices:n["auth:defaultModbusAccess:modbusDevicesAccess"]},modbusAuthErrorCode:parseInt(n["auth:modbusAuthErrorCode"]),sessionTtl:parseInt(n["auth:sessionTtl"])}}}async function U(e,t){let s=(0,z.bH)();return await (0,z.ri)(s,"/api/confs/set/",{method:"POST",body:JSON.stringify({[e]:t})}),B(["/api/confs/set/",s])}async function H(e){let t=(0,z.bH)(),s={"auth:modbusAuthErrorCode":e.modbus.modbusAuthErrorCode.toString(),"auth:sessionTtl":e.modbus.sessionTtl.toString()};await (0,z.ri)(t,"/api/confs/set/",{method:"POST",body:JSON.stringify(s)})}let _=[{label:"No access",value:"none"},{label:"Read",value:"read"},{label:"Read/Write",value:"readWrite"}];function R(e){let{settings:t,mutateSettings:s,users:r,mutateUsers:u,freeAccess:h,mutateFreeAccess:p,setAddUserModalOpened:m,setChangeUserPasswordModalOpened:b,setAddFreeRangeModalOpened:x,setCurrentUsername:v,authUsername:y}=e;return(0,n.jsx)(C.Z,{status:"disabled",name:"Users & Access",icon:(0,n.jsx)(g.Z,{}),bg:"gray.0",addEl:(0,n.jsx)(i.z,{ml:"sm",leftIcon:(0,n.jsx)(f.Z,{size:14}),compact:!0,onClick:()=>m(!0),children:"Add user"}),settings:{title:"Access settings",onSettingsUpdate:()=>{s()},form:A,useSettings:()=>({data:t,mutate:s}),save:async e=>{await H(e)}},children:(0,n.jsxs)(o.i,{w:"100%",verticalSpacing:"xs",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{backgroundColor:"#fff"},children:[(0,n.jsx)("th",{children:"Username"}),(0,n.jsx)("th",{children:"Access Method"}),(0,n.jsx)("th",{children:"OPCB"}),(0,n.jsx)("th",{children:"Connected Devices"}),(0,n.jsx)("th",{})]})}),(0,n.jsxs)("tbody",{children:[Array.from(r.entries()).map(e=>{let[t,s]=e;return(0,n.jsx)(W,{user:s,currentUser:y,mutate:u,openChangePasswordModal:e=>{v(e),b(!0)}},t.toString())}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{colSpan:2,children:(0,n.jsx)("b",{children:"Unauthenticated Modbus access:"})}),(0,n.jsx)("td",{children:(0,n.jsx)(a.s,{value:t.modbus.defaultAccess.configuration,data:_,onChange:e=>(0,M.M)(()=>s(U("auth:defaultModbusAccess:configurationAccess",e),{optimisticData:()=>{let s=j().cloneDeep(t);return s.modbus.defaultAccess.configuration=e,s}}))})}),(0,n.jsx)("td",{children:(0,n.jsx)(a.s,{data:_,value:t.modbus.defaultAccess.connectedDevices,onChange:e=>(0,M.M)(()=>s(U("auth:defaultModbusAccess:modbusDevicesAccess",e),{optimisticData:()=>{let s=j().cloneDeep(t);return s.modbus.defaultAccess.connectedDevices=e,s}}))})}),(0,n.jsx)("td",{})]}),(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{colSpan:2,valign:"top",style:{borderTop:"none"},children:[(0,n.jsx)(c.x,{weight:700,children:"Always allow Modbus ranges:"}),(0,n.jsx)(c.x,{size:"xs",maw:"300px",children:"OPCB will always allow Modbus read/write access for the requests in those ranges. Note, that if you remove OPCB password input registers range, Modbus clients will not be able to authenticate at all."})]}),(0,n.jsx)("td",{colSpan:3,style:{borderTop:"none"},children:(0,n.jsxs)(d.K,{spacing:4,children:[Array.from(h.entries()).map(e=>{let[t,s]=e;return(0,n.jsx)(q,{range:s,mutate:p},t.toString())}),(0,n.jsx)(l.A,{color:"blue",onClick:()=>x(!0),children:(0,n.jsx)(f.Z,{size:16})})]})})]})]})]})})}function W(e){let{user:t,currentUser:s,mutate:r,openChangePasswordModal:i}=e,o=t.username===s||"admin"===t.username,d=e=>(0,M.M)(()=>{let s=j().cloneDeep(t);return e(s),r(Z(s),{optimisticData:e=>e.map(e=>e.username===t.username?s:e)})});return(0,n.jsxs)("tr",{style:{backgroundColor:"#fff"},children:[(0,n.jsx)("td",{children:(0,n.jsx)(c.x,{weight:700,children:t.username})}),(0,n.jsx)("td",{children:(0,n.jsxs)(u.Z,{children:[(0,n.jsx)(h.r,{label:"API",checked:t.allowApi,disabled:o,onChange:e=>d(t=>(t.allowApi=e.currentTarget.checked,t))}),(0,n.jsx)(h.r,{label:"Modbus",checked:t.allowModbus,disabled:o,onChange:e=>d(t=>(t.allowModbus=e.currentTarget.checked,t))})]})}),(0,n.jsx)("td",{children:(0,n.jsx)(a.s,{data:_,value:t.level.configuration,disabled:o,onChange:e=>d(t=>(t.level.configuration=e,t))})}),(0,n.jsx)("td",{children:(0,n.jsx)(a.s,{data:_,value:t.level.connectedDevices,disabled:o,onChange:e=>d(t=>(t.level.connectedDevices=e,t))})}),(0,n.jsx)("td",{children:(0,n.jsxs)(u.Z,{spacing:"xs",position:"right",children:[(0,n.jsx)(p.u,{label:"Change password",children:(0,n.jsx)(l.A,{color:"blue",onClick:()=>i(t.username),children:(0,n.jsx)(m,{size:16,stroke:1.5})})}),(0,n.jsx)(O.Z,{title:"Delete user",description:'Are you sure you want to delete account "'.concat(t.username,'"?'),buttonText:"Delete",children:(0,n.jsx)(l.A,{color:"red",disabled:o,onClick:()=>{(0,M.M)(()=>r(I(t.username),{optimisticData:e=>e.filter(e=>e.username!==t.username)}))},children:(0,n.jsx)(b.Z,{size:16,stroke:1.5})})})]})})]})}function q(e){let{range:t,mutate:s}=e;return(0,n.jsxs)(u.Z,{bg:"gray.2",p:"xs",sx:e=>({borderRadius:e.radius.sm}),spacing:"md",noWrap:!0,children:[(0,n.jsxs)(u.Z,{spacing:4,align:"baseline",noWrap:!0,miw:113,children:[(0,n.jsx)(c.x,{weight:700,children:"Device ID:"}),(0,n.jsx)(c.x,{children:void 0===t.device?"OPCB":t.device})]}),(0,n.jsxs)(u.Z,{spacing:4,align:"baseline",noWrap:!0,miw:100,children:[(0,n.jsx)(c.x,{weight:700,children:"Function:"}),(0,n.jsx)(c.x,{children:t.function})]}),(0,n.jsxs)(u.Z,{spacing:4,align:"baseline",noWrap:!0,children:[(0,n.jsx)(c.x,{weight:700,children:"Registers:"}),(0,n.jsx)(c.x,{size:"xs",children:t.range})]}),(0,n.jsx)(O.Z,{title:"Delete range",description:"Are you sure you want to delete range?",buttonText:"Delete",children:(0,n.jsx)(l.A,{size:"sm",color:"red",ml:"auto",onClick:()=>{(0,M.M)(()=>s(N(t),{optimisticData:e=>e.filter(e=>e!==t)}))},children:(0,n.jsx)(b.Z,{size:16,stroke:1.5})})})]})}var $=s(9494),J=s(9458),K=s(6080),F=s(6485);function L(e){let{initialValues:t,onSubmit:s,saving:r}=e,i=(0,y.c)({initialValues:t,validate:{device:(0,F.Sg)(e=>!e.opcb,(0,w.m)({min:0,max:255},"Must be in range 0-255")),function:(0,w.m)({min:1,max:127},"Must be in range 1-127"),range:(0,K.w)(/^(\d+-\d+,)*\d+-\d+$/,'Format: "startAddress-endAddress,startAddress-endAddress,...". Example: "0-10,20-30".')}});return(0,n.jsx)("form",{onSubmit:i.onSubmit(s),children:(0,n.jsxs)(d.K,{children:[(0,n.jsx)($.X,{label:"OPCB Modbus ID",checked:i.values.opcb,...i.getInputProps("opcb")}),!i.values.opcb&&(0,n.jsx)(v.Y,{label:"Device Modbus ID (decimal):",...i.getInputProps("device")}),(0,n.jsx)(v.Y,{label:"Modbus Function (decimal):",...i.getInputProps("function")}),(0,n.jsx)(J.o,{label:"Registers range:",...i.getInputProps("range")}),(0,n.jsx)(S.Z,{type:"submit",inProgress:r,children:"Save"})]})})}var X=s(293),Y=s(9454);function Q(e){let{initialValues:t,onSubmit:s,saving:r}=e,i=(0,y.c)({initialValues:t,validate:{username:(0,Y.d)({min:3,max:30},"Must have 3-30 characters"),password:(0,Y.d)({min:3,max:30},"Must have 3-30 characters")}});return(0,n.jsx)("form",{onSubmit:i.onSubmit(s),children:(0,n.jsxs)(d.K,{children:[(0,n.jsx)(J.o,{label:"Username:",...i.getInputProps("username"),required:!0}),(0,n.jsx)(X.W,{label:"Password:",...i.getInputProps("password"),required:!0}),(0,n.jsx)(S.Z,{type:"submit",inProgress:r,children:"Save"})]})})}function V(e){let{initialValues:t,onSubmit:s,saving:r}=e,i=(0,y.c)({initialValues:t,validate:{password:(0,Y.d)({min:3,max:30},"Must have 3-30 characters")}});return(0,n.jsx)("form",{onSubmit:i.onSubmit(s),children:(0,n.jsxs)(d.K,{children:[(0,n.jsx)(X.W,{label:"New password:",...i.getInputProps("password"),required:!0}),(0,n.jsx)(S.Z,{type:"submit",inProgress:r,children:"Save"})]})})}var G=s(5384),ee=s(9266);function et(){let e=(0,z.tQ)("access-settings",B),t=(0,z.tQ)("/api/users/",P.ph),s=(0,z.tQ)("/api/modbus/free-ranges/",P.ph),i=(0,z.pk)(),[o,a]=r.useState(!1),[c,d]=r.useState(!1),[l,u]=r.useState(!1),[h,p]=r.useState();return e.data&&t.data&&s.data&&i.token?(0,n.jsxs)(ee.Z,{pageTitle:"Access management",children:[(0,n.jsx)(G.Z,{title:"Add account",onSettingsUpdate:()=>{t.mutate()},form:Q,useSettings:()=>({data:{username:"",password:""},error:void 0,isValidating:!1,isLoading:!1,mutate:async()=>void 0}),save:e=>D(e.username,e.password),opened:o,setOpened:a}),(0,n.jsx)(G.Z,{title:'Change password for the account "'.concat(h,'"'),form:V,useSettings:()=>({data:{username:h,password:""},error:void 0,isValidating:!1,isLoading:!1,mutate:async()=>void 0}),save:e=>T(e.username,e.password),opened:c,setOpened:d}),(0,n.jsx)(G.Z,{title:"Add free access to the Modbus range",form:L,onSettingsUpdate:()=>{s.mutate()},useSettings:()=>({data:{opcb:!0,device:void 0,function:3,range:""},error:void 0,isValidating:!1,isLoading:!1,mutate:async()=>void 0}),save:async e=>(e.opcb&&(e.device=void 0),E(e)),opened:l,setOpened:u}),(0,n.jsx)(R,{settings:e.data,mutateSettings:e.mutate,users:t.data,mutateUsers:t.mutate,freeAccess:s.data,mutateFreeAccess:s.mutate,setAddUserModalOpened:a,setCurrentUsername:p,setChangeUserPasswordModalOpened:d,setAddFreeRangeModalOpened:u,authUsername:i.token.username})]}):(0,n.jsx)(ee.Z,{pageTitle:"Access management",contentIsLoading:!0})}}},function(e){e.O(0,[944,473,13,953,167,266,774,888,179],function(){return e(e.s=3285)}),_N_E=e.O()}]);