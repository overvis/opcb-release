(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[498],{2878:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/internet",function(){return s(17)}])},5973:function(e,n,s){"use strict";s.d(n,{Z:function(){return CenteredStatusInfo}});var t=s(966),i=s(8255),o=s(462),r=s(7344),c=s(3979),a=s(9956),l=s(431);function CenteredStatusInfo(e){let{icon:n,text:s,description:d,children:u,color:x,...h}=e;return(0,t.jsx)(i.M,{h:"100%",p:"xs",...h,children:(0,t.jsxs)(o.K,{p:"sm",spacing:"xs",align:"center",justify:"center",children:[(0,t.jsxs)(r.Z,{spacing:"xs",align:"start",position:"center",children:[(0,t.jsx)(c.k,{color:x||"black",size:"md",variant:"outline",sx:{border:"none"},children:n||(0,t.jsx)(l.Z,{})}),(0,t.jsx)(a.x,{color:x||"black",align:"center",children:s})]}),d&&(0,t.jsx)(a.x,{size:"xs",color:"dimmed",align:"center",children:d}),u]})})}},5451:function(e,n,s){"use strict";s.d(n,{Z:function(){return DisabledStatus}});var t=s(966),i=s(5973);function DisabledStatus(e){let{error:n,...s}=e;return(0,t.jsx)(i.Z,{...s,p:"xs",bg:"gray.0",color:n?"red":"gray"})}},7723:function(e,n,s){"use strict";var t=s(9025);n.Z=(0,t.k)(e=>({dirtyInput:{backgroundColor:e.colors.blue[0]}}))},477:function(e,n,s){"use strict";s.d(n,{Z:function(){return RxTxDisplay}});var t=s(966),i=s(1949),o=s(4137),r=s(2242),c=s(8431),a=s(3610);function RxTxDisplay(e){let{bytes:n,lastBytesSinceSec:s,speed:l,dbm:d,tx:u,oneline:x=!0}=e,h=(0,i.rZ)(),p=void 0!==s&&s<=2?h.colors.green[6]:h.colors.gray[6];return(0,t.jsx)(a.Z,{icon:u?(0,t.jsx)(o.Z,{stroke:1,height:15,color:p}):(0,t.jsx)(r.Z,{stroke:1,height:15,color:p}),name:u?"TX":"RX",subNameVal:d?"".concat(d," dBm"):void 0,nameColor:p,mainVal:(0,c.td)(n),subVal:{level:void 0!==s&&s<=2?"good":"dimmed",value:"".concat((0,c.td)(l),"/s")},oneline:x})}},3732:function(e,n,s){"use strict";s.d(n,{Z:function(){return StatusBlock}});var t=s(966),i=s(4418),o=s(462),r=s(7344),c=s(3979),a=s(9956),l=s(9977),d=s(3127),u=s(8637);function StatusBlock(e){let n="connected"===e.status?"green":"warn"===e.status?"orange":"disconnected"===e.status?"red":"gray";return(0,t.jsx)(i.X,{h:"100%",withBorder:!0,children:(0,t.jsxs)(o.K,{spacing:0,h:"100%",children:[(0,t.jsxs)(r.Z,{position:"apart",align:"center",p:"xs",sx:e=>({borderBottom:"1px solid ".concat(e.colors.gray[3])}),children:[(0,t.jsxs)(r.Z,{spacing:"xs",noWrap:!0,children:[(0,t.jsx)(c.k,{color:n,variant:"light",children:e.icon}),(0,t.jsx)(a.x,{weight:500,c:n,transform:"uppercase",children:e.name}),e.addEl&&"string"==typeof e.addEl?(0,t.jsx)(a.x,{c:"dimmed",size:"sm",children:e.addEl}):e.addEl]}),(0,t.jsxs)(r.Z,{spacing:"xs",noWrap:!0,children:[e.addElRight,e.settingsAction&&(0,t.jsx)(l.A,{color:"blue",onClick:e.settingsAction,children:(0,t.jsx)(u.Z,{size:18})})]})]}),(0,t.jsx)(d.x,{bg:e.bg,h:"100%",children:e.children})]})})}},169:function(e,n,s){"use strict";s.d(n,{Z:function(){return StatusBlockWithSettings}});var t=s(966),i=s(3900),o=s(8253),r=s(3732);function StatusBlockWithSettings(e){let[n,s]=(0,i.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Z,{...e.settings,opened:n,setOpened:s}),(0,t.jsx)(r.Z,{...e,settingsAction:()=>s(!0),children:e.children})]})}},2323:function(e,n,s){"use strict";s.d(n,{Z:function(){return StatusInfo}});var t=s(966),i=s(1949),o=s(7344),r=s(3624),c=s(462),a=s(9956),l=s(4351),d=s(4418),u=s(2922);function StatusInfo(e){let{iface:n,children:s,dest:x,text:h,error:p,ok:v,dhcpEnabled:m,attemptNum:j}=e,g=(0,i.rZ)();return(0,t.jsxs)(o.Z,{align:"start",spacing:"sm",noWrap:!0,p:"xs",children:[v?(0,t.jsx)(u.Z,{color:g.colors.green[6]}):(0,t.jsx)(r.a,{mt:9,size:22,color:"dark"}),(0,t.jsxs)(c.K,{spacing:"xs",children:[(0,t.jsxs)(c.K,{spacing:0,children:[(0,t.jsxs)(a.x,{color:v?"green":"dark",children:[h||(v?"Connected":"Connecting"),x&&(0,t.jsxs)(t.Fragment,{children:[" ","to ",(0,t.jsx)("b",{children:x})]}),j&&(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsxs)(a.x,{color:"dimmed",size:"xs",span:!0,children:["(attempt ",j,")"]})]})]}),(0,t.jsxs)(o.Z,{spacing:"sm",children:[(0,t.jsx)(a.x,{color:"dimmed",size:"sm",lh:1,children:n}),void 0!==m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.i,{orientation:"vertical",my:1}),(0,t.jsx)(a.x,{size:"sm",c:"dimmed",lh:1,children:m?"DHCP enabled":"DHCP disabled"})]})]})]}),p&&(0,t.jsx)(a.x,{size:"sm",c:"red",children:p}),s&&(0,t.jsx)(d.X,{bg:"gray.0",p:"xs",ml:"-xs",children:(0,t.jsx)(o.Z,{align:"start",position:"left",children:s})})]})]})}},3610:function(e,n,s){"use strict";s.d(n,{Z:function(){return ValueDisplay}});var t=s(966),i=s(9956),o=s(7344),r=s(462);function ValueDisplay(e){let{icon:n,name:s,subNameVal:c,nameColor:a="dimmed",mainVal:l,subVal:d,oneline:u}=e,x=!function(e){for(var n=arguments.length,s=Array(n>1?n-1:0),t=1;t<n;t++)s[t-1]=arguments[t];return"object"==typeof e&&null!==e&&s.every(n=>n in e)}(d,"value","level")?d:(0,t.jsxs)(t.Fragment,{children:[d.name&&d.name+" ",(0,t.jsx)(i.x,{span:!0,c:"good"===d.level?"green":"medium"===d.level?"orange":"bad"===d.level?"red":"dimmed",transform:"none",children:d.value})]}),h=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Z,{spacing:5,children:[(0,t.jsx)(i.x,{weight:"bold",size:"xs",color:a,transform:"uppercase",children:s}),c&&(0,t.jsx)(i.x,{size:10,color:"dimmed",children:c})]}),(0,t.jsx)(i.x,{fz:"xs",color:"black",children:l}),x&&(0,t.jsx)(i.x,{size:10,color:"dimmed",children:x})]});return u?(0,t.jsxs)(o.Z,{spacing:5,align:"baseline",noWrap:!0,children:[(0,t.jsx)("div",{style:{position:"relative",top:"2px",marginTop:"-5px",marginRight:"-4px"},children:n}),h]}):(0,t.jsxs)(o.Z,{spacing:0,align:"baseline",noWrap:!0,children:[(0,t.jsx)("div",{style:{position:"relative",top:"2px",marginTop:"-5px"},children:n}),(0,t.jsx)(r.K,{spacing:0,children:h})]})}s(3900)},17:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return Page}});var t=s(966),i=s(5782),o=s(3283),r=s(462),c=s(8482),a=s(3127),l=s(4351),d=s(9956),u=s(2308),x=s(7344),h=s(480),p=s(7443),v=s(1625),m=s(5897),j=s(3249),g=s(9280),f=s(4853),b=s(5385),y=s(3900),Z=s(9804),C=s(1039),S=s(52),P=s(3738);async function settingsFetcher(e){let[n,s]=e,t=await (0,P.wv)(s,["overvisVpn:isEnabled","overvisVpn:wireguard:ipAddressCidr","overvisReverseConnection:interface","overvisReverseConnection:hostname","overvisReverseConnection:port"]),i={available:!!t["overvisVpn:wireguard:ipAddressCidr"],enabled:"true"===t["overvisVpn:isEnabled"]},o={enabled:!!t["overvisReverseConnection:interface"]&&"disabled"!==t["overvisReverseConnection:interface"],iface:"elan"===t["overvisReverseConnection:interface"]?"elan":"wlan"===t["overvisReverseConnection:interface"]?"wlan":"any",hostname:t["overvisReverseConnection:hostname"]||"",port:parseInt(t["overvisReverseConnection:port"]||"20502",10)};return{vpn:i,rc:o}}function useSettings(){let e=(0,S.tQ)("cloud-settings",settingsFetcher);return{...e}}async function saveSettings(e){let n={"overvisVpn:isEnabled":e.vpn.enabled?"true":"false","overvisReverseConnection:interface":e.rc.enabled?e.rc.iface:"disabled"};return e.rc.enabled&&(n["overvisReverseConnection:hostname"]=e.rc.hostname,n["overvisReverseConnection:port"]=e.rc.port.toString()),(0,P.NC)(n)}async function unbindCloudAccount(){return(0,P.NC)({"overvisVpn:boundToOcpServer":"","overvisVpn:boundToOcpAccountEmail":""})}var w=s(8431),V=s(5973),k=s(2763),O=s(5041),I=s(6886),z=s(6356),N=s(6078),D=s(8393),B=s(9724),E=s(9561),T=s(6169),M=s(7452),A=s(7723),F=s(29);function CloudSettingsForm(e){let{saving:n,initialValues:s,onSubmit:i}=e,[o,a]=(0,y.useState)(!1),[l,u]=(0,y.useState)(!1),{classes:x}=(0,A.Z)(),p=(0,B.c)({initialValues:s,validate:{rc:{hostname:(e,n)=>{if(n.rc.enabled&&!T.C6.test(e))return"Invalid hostname"},port:(0,T.Sg)(e=>e.rc.enabled,(0,E.m)({min:1,max:65535},"Should be in range 1-65535"))}}});return(0,t.jsx)("form",{onSubmit:p.onSubmit(async e=>{let n=await i(e);n&&p.resetDirty()}),children:(0,t.jsxs)(r.K,{children:[(0,t.jsx)(d.x,{color:"dimmed",size:"xs",children:"OPCB supports two kinds of connections to Overvis cloud: VPN and Modbus TCP. VPN should be used if avaliable, as it is more secure, faster and provides a full access to the device from the cloud. VPN access is only available for the devices registered with Overvis. Modbus TCP is a fallback option that provides an access to the OPCB (and connected devices) registers using unsecured Modbus connection."}),(0,t.jsx)(d.x,{color:"dimmed",size:"xs",children:"Both connections can work in parallel, but if VPN connection is enabled, Modbus TCP connection can be safely turned off."}),(0,t.jsxs)(r.K,{spacing:0,children:[(0,t.jsx)(k.D,{order:3,children:"VPN"}),(0,t.jsx)(h.e,{fz:"xs",onClick:()=>a(!o),children:"How it works..."}),(0,t.jsx)(c.U,{in:o,children:(0,t.jsxs)(r.K,{spacing:"xs",children:[(0,t.jsxs)(d.x,{color:"gray.8",size:"xs",children:["During the manufacturing, each OPCB controller is assigned an IP address inside the Overvis VPN network. This VPN is based on WireGuard protocol which is fully encrypted using industry-standard algorhithms (see"," ",(0,t.jsx)(h.e,{href:"https://www.wireguard.com/protocol/",children:"https://www.wireguard.com/protocol/"})," ","for details). If enabled here, the VPN connection is established automatically when the device has internet access."]}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"VPN connection provides the Overvis server with an access to the OPCB API, which allows fast and stable data transfer and also gives the ability to proxy the OPCB web-interface through the cloud."}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"To connect the VPN-enabled device to your Overvis account all you have to do is to provide the PIN code that was assigned to your device during the manufacturing. Using this PIN, Overvis can find your device's IP address inside the VPN. If you need to reassign the device to some other Overvis account, you have to unbind it from the current account first."})]})})]}),p.values.vpn.available?(0,t.jsx)(O.r,{label:"Enable",classNames:{input:p.isDirty("vpn.enabled")&&x.dirtyInput||void 0},checked:p.values.vpn.enabled,...p.getInputProps("vpn.enabled")}):(0,t.jsxs)(d.x,{color:"dimmed",size:"sm",children:["VPN connection is unavailable. Please contact"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})," if you want to register your device."]}),(0,t.jsxs)(r.K,{spacing:0,children:[(0,t.jsx)(k.D,{order:3,children:"Modbus TCP"}),(0,t.jsx)(h.e,{fz:"xs",onClick:()=>u(!l),children:"How it works..."}),(0,t.jsx)(c.U,{in:l,children:(0,t.jsxs)(r.K,{spacing:"xs",children:[(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"Modbus TCP cloud connection acts similar to the OPCB Modbus TCP server, but the connection is established in reverse, e.g. the OPCB server itself connects to the Overvis client. This gives the abitlity to establish the connection even if the device is behind a firewall or NAT. After the connection, OPCB authenticates with its MAC-address and Overvis assigns this OPCB to Overvis account."}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:'If Overvis can\'t find any account that have access to this device, it sends a randomly-generated "Activation Code" value to OPCB. This code is shown in the cloud status panel. By providing this code back to Overvis, you confirm that your account can access this device.'}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"After the device is assigned to your account, Overvis communicates with OPCB by using standard Modbus TCP protocol. It is not encrypted and relatively slow. It is better to use the VPN connection option if your device is registered with Overvis, i.e. if you have a PIN code."})]})})]}),(0,t.jsx)(O.r,{label:"Enable",classNames:{input:p.isDirty("rc.enabled")&&x.dirtyInput||void 0},checked:p.values.rc.enabled,...p.getInputProps("rc.enabled")}),p.values.rc.enabled&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Z,{children:(0,t.jsx)(I.Ph,{label:"Interface:",description:"Which network interface to use to establish the connection to Overvis.",data:[{label:"Any",value:"any"},{label:"Ethernet",value:"elan"},{label:"Wi-Fi",value:"wlan"}],classNames:{input:p.isDirty("rc.iface")&&x.dirtyInput||void 0},withinPortal:!0,...p.getInputProps("rc.iface")})}),(0,t.jsxs)(z.M,{cols:2,children:[(0,t.jsx)(F.Z,{children:(0,t.jsx)(N.o,{label:"Hostname:",description:"Hostname of Overvis server to connect to.",required:!0,classNames:{input:p.isDirty("rc.hostname")&&x.dirtyInput||void 0},...p.getInputProps("rc.hostname")})}),(0,t.jsx)(F.Z,{children:(0,t.jsx)(D.Y,{label:"Port:",description:"Port of Overvis server to connect to. Value from 1 to 65535.",required:!0,min:1,max:65535,hideControls:!0,classNames:{input:p.isDirty("rc.port")&&x.dirtyInput||void 0},...p.getInputProps("rc.port")})})]})]}),(0,t.jsx)(M.Z,{type:"submit",inProgress:n,children:"Save"})]})})}var K=s(5451),R=s(2671),L=s(4418),_=s(2546),W=s(2383);function HiddenCode(e){let[n,s]=y.useState(!0);return n?(0,t.jsxs)(_.E,{...e,sx:{cursor:"pointer"},onClick:()=>{e.cb&&e.cb(!1),s(!1)},children:[(0,t.jsx)(W.Z,{size:"10px",style:{position:"relative",top:"1px"}})," Show"]}):(0,t.jsx)(_.E,{...e})}var U=s(3610);function OvervisVpnLabel(e){let{hasRegistration:n,pin:s,mac:i,publicKey:o,privateKey:c,model:a,assignedVpnIp:u}=e,[p,v]=y.useState(!0);return(0,t.jsxs)(r.K,{spacing:"xs",pt:13,children:[(0,t.jsx)(d.x,{align:"center",color:"gray.5",size:"md",transform:"uppercase",weight:500,pb:"1px",children:"Registration"}),(0,t.jsx)(l.i,{color:"gray.4"}),n?(0,t.jsxs)(r.K,{children:[(0,t.jsx)(x.Z,{position:"center",children:(0,t.jsx)("a",{href:"/dyn-media/label.png",target:"_blank",style:{position:"relative"},children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.E,{src:"/dyn-media/label.png",alt:"OPCB VPN information label.",maw:"260px"}),p&&(0,t.jsx)("div",{style:{position:"absolute",zIndex:100,height:"15px",top:40,left:10,width:"235px",backgroundColor:"#eee"}})||null]})})}),(0,t.jsx)(L.X,{bg:"gray.2",p:"xs",children:(0,t.jsxs)(r.K,{align:"left",spacing:"xs",children:[(0,t.jsxs)(x.Z,{children:[(0,t.jsx)(U.Z,{name:"PIN",mainVal:(0,t.jsx)(_.E,{children:s})}),(0,t.jsx)(U.Z,{name:"MAC",mainVal:(0,t.jsx)(_.E,{children:i})}),(0,t.jsx)(U.Z,{name:"Assigned IP",mainVal:(0,t.jsx)(_.E,{children:u})})]}),(0,t.jsx)(U.Z,{name:"Wireguard VPN Keys",mainVal:(0,t.jsxs)(r.K,{mt:3,spacing:3,children:[(0,t.jsxs)(x.Z,{align:"baseline",spacing:0,children:[(0,t.jsx)(d.x,{fz:"xs",color:"dimmed",miw:50,children:"Public:"}),(0,t.jsx)(_.E,{color:"dimmed",fz:"10px",children:o})]}),(0,t.jsxs)(x.Z,{align:"baseline",spacing:0,children:[(0,t.jsx)(d.x,{fz:"xs",color:"dimmed",miw:50,children:"Private:"}),(0,t.jsx)(HiddenCode,{color:"dimmed",fz:"10px",cb:v,children:c})]})]})})]})})]}):(0,t.jsxs)(r.K,{children:[(0,t.jsxs)(r.K,{spacing:4,children:[(0,t.jsx)(d.x,{ta:"center",color:"orange",children:"This device is not registered in Overvis cloud."}),(0,t.jsx)(d.x,{ta:"center",size:"sm",color:"dimmed",children:"You can still connect it to the cloud using Modbus, but you are missing the ability to securely access OPCB interface from the internet."}),(0,t.jsx)(d.x,{ta:"center",size:"sm",children:"Please contact us if you wish to acquire a registration:"}),(0,t.jsx)(h.e,{size:"sm",ta:"center",href:"mailto:support@overvis.com",children:"support@overvis.com"})]}),(0,t.jsx)(l.i,{color:"gray.4"}),(0,t.jsxs)(x.Z,{align:"start",position:"left",children:[(0,t.jsx)(U.Z,{name:"MODEL",mainVal:(0,t.jsx)(_.E,{children:a})}),(0,t.jsx)(U.Z,{name:"MAC",mainVal:(0,t.jsx)(_.E,{children:i})}),(0,t.jsx)(U.Z,{name:"PUBKEY",mainVal:(0,t.jsx)(_.E,{fz:"11px",children:o})})]})]})]})}var G=s(477),H=s(169),X=s(2323);function CloudStatus(e){let{internet:n,vpn:s,rc:l,updateStatus:d}=e,[u,x]=(0,y.useState)(!1),h="online"===s.connection.status||"online"===l.status?"connected":"offline"===s.connection.status&&"offline"===l.status?"disconnected":"disabled";return(0,t.jsxs)(i.r,{children:[(0,t.jsx)(i.r.Col,{md:8,children:(0,t.jsx)(H.Z,{icon:"online"===s.connection.status?(0,t.jsx)(p.Z,{}):(0,t.jsx)(v.Z,{}),name:"Overvis Cloud",status:h,settings:{size:700,title:"Overvis Cloud connection settings",form:CloudSettingsForm,useSettings:useSettings,save:saveSettings,onSettingsUpdate:d},addEl:(0,t.jsx)(o.z,{variant:"subtle",compact:!0,size:"xs",radius:"xl",styles:{leftIcon:{marginRight:4}},py:2,leftIcon:(0,t.jsx)(m.Z,{size:14}),onClick:()=>x(!u),children:u?"Hide details":"Show details"}),children:(0,t.jsxs)(r.K,{h:"100%",spacing:0,children:[(0,t.jsx)(c.U,{in:u,children:(0,t.jsx)(DetailedInfo,{rc:l,vpn:s})}),(0,t.jsx)(a.x,{style:{flex:1},children:(0,t.jsx)(CloudStatusContent,{internet:n,vpn:s,rc:l})})]})})}),(0,t.jsx)(i.r.Col,{md:4,children:(0,t.jsx)(OvervisVpnLabel,{hasRegistration:"unregistered"!==s.connection.status,pin:s.pin,mac:s.mac,privateKey:s.privateKey,publicKey:s.publicKey,model:s.model,assignedVpnIp:s.assignedVpnIp})})]})}function DetailedInfo(e){let{rc:n,vpn:s}=e;return(0,t.jsx)(a.x,{p:"xs",bg:"gray.1",sx:e=>({borderBottom:"1px solid ".concat(e.colors.gray[3])}),children:(0,t.jsxs)(r.K,{spacing:"xs",children:[(0,t.jsx)(VpnDetailedInfo,{vpn:s.connection}),(0,t.jsx)(l.i,{color:"gray.3",mx:"-xs"}),(0,t.jsx)(RcDetailedInfo,{rc:n})]})})}function VpnDetailedInfo(e){let{vpn:n}=e,s=n.status,[i,o]="online"===s?["Connected","green"]:"offline"===s?["Disconnected","red"]:"disabled"===s?["Disabled","gray"]:["Unregistered","dimmed"];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.x,{fz:"sm",tt:"uppercase",fw:"bold",children:["VPN"," ",(0,t.jsx)(u.C,{color:o,size:"xs",children:i})]}),"disabled"!==n.status&&"unregistered"!==n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(U.Z,{name:"Interface",mainVal:n.interface,oneline:!0}),(0,t.jsx)(U.Z,{name:"VPN IP",mainVal:n.ip,oneline:!0}),"online"===n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(U.Z,{name:"RX",mainVal:(0,w.td)(n.rxtx.rxTotalBytes),oneline:!0}),(0,t.jsx)(U.Z,{name:"TX",mainVal:(0,w.td)(n.rxtx.txTotalBytes),oneline:!0})]})]}),(0,t.jsxs)(x.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(U.Z,{name:"Endpoint",mainVal:n.vpnServer,oneline:!0}),(0,t.jsx)(U.Z,{name:"Endpoint VPN IP",mainVal:n.serverInternalIp,oneline:!0}),(0,t.jsx)(U.Z,{name:"Endpoint Key",mainVal:n.serverPublicKey,oneline:!0})]})]})]})}function RcDetailedInfo(e){let{rc:n}=e,s=n.status,[i,o]="online"===s||"unbound"===s?["Connected","green"]:"offline"===s?["Disconnected","red"]:["Disabled","gray"];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.x,{fz:"sm",tt:"uppercase",fw:"bold",children:["Modbus TCP"," ",(0,t.jsx)(u.C,{color:o,size:"xs",children:i})]}),"disabled"!==n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(U.Z,{name:"Interface",mainVal:n.interface,oneline:!0}),(0,t.jsx)(U.Z,{name:"Overvis Server",mainVal:n.ocpServer,oneline:!0}),(0,t.jsx)(U.Z,{name:"Own MAC",mainVal:n.mac,oneline:!0}),"offline"===n.status&&n.lastConnectionOn&&(0,t.jsx)(U.Z,{name:"Last connection on",mainVal:(0,Z.o0)(n.lastConnectionOn),oneline:!0})]}),("online"===n.status||"unbound"===n.status)&&(0,t.jsxs)(x.Z,{sx:{rowGap:"2px"},align:"start",children:[(0,t.jsx)(U.Z,{name:"Connected for",mainVal:(0,w.Ch)(n.connectedSec),oneline:!0}),(0,t.jsx)(G.Z,{bytes:n.rxtx.rxConnectionBytes,speed:n.rxtx.rxSpeedBytesPerSec,lastBytesSinceSec:n.rxtx.rxLastBytesSinceSec}),(0,t.jsx)(G.Z,{bytes:n.rxtx.txConnectionBytes,speed:n.rxtx.txSpeedBytesPerSec,lastBytesSinceSec:n.rxtx.txLastBytesSinceSec,tx:!0})]})]})]})}function CloudStatusContent(e){let{internet:n,vpn:s,rc:i}=e,o=s.connection;return"disabled"===n.status?(0,t.jsx)(K.Z,{icon:(0,t.jsx)(j.Z,{}),text:"Internet access is disabled for this device.",description:"This device is unreachable from the internet, only LAN access is enabled. All cloud functionality is disabled."}):"offline"===n.status?(0,t.jsx)(K.Z,{icon:(0,t.jsx)(j.Z,{}),text:"Device is offline.",error:!0,description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Set up the internet connection to access this device from Overvis Cloud."}),(0,t.jsxs)(d.x,{children:["Consult ",(0,t.jsx)(h.e,{href:"https://docs.overvis.com/#/OPCB/",children:"documentation"})," or contact support:"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})]})]})}):"unregistered"===o.status?"disabled"===i.status?(0,t.jsx)(K.Z,{icon:(0,t.jsx)(g.Z,{}),text:"Modbus TCP connection to Overvis cloud is disabled for this device.",description:"Device has internet access but is not attempting to connect to the cloud."}):(0,t.jsx)(RcConnectionStatus,{rc:i}):"disabled"===o.status&&"disabled"===i.status?(0,t.jsx)(K.Z,{icon:(0,t.jsx)(g.Z,{}),text:"VPN connection to Overvis cloud is disabled for this device.",description:(0,t.jsx)(VpnDisabledDescription,{rcDisabled:!0})}):"disabled"===i.status||"online"===o.status?(0,t.jsx)(VpnConnectionStatus,{vpn:o}):(0,t.jsxs)(r.K,{spacing:0,children:[(0,t.jsx)(VpnConnectionStatus,{vpn:o}),(0,t.jsx)(l.i,{variant:"dotted"}),(0,t.jsx)(RcConnectionStatus,{rc:i})]})}function VpnDisabledDescription(e){let{rcDisabled:n}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"This device is registered in Overvis Cloud but VPN access is disabled in the device settings."}),n?(0,t.jsx)(d.x,{children:"Modbus TCP connection is disabled too."}):(0,t.jsx)(d.x,{children:"Modbus TCP connection is enabled, but it doesn't provide a secure remote access to device interface."}),(0,t.jsx)(d.x,{color:"black",children:"Enable VPN to access this device from the cloud securely."})]})}function VpnConnectionStatus(e){let{vpn:n}=e;return"disabled"===n.status?(0,t.jsx)(V.Z,{color:"gray",text:"Overvis VPN connection is disabled.",icon:(0,t.jsx)(g.Z,{}),description:(0,t.jsx)(VpnDisabledDescription,{})}):"offline"===n.status?(0,t.jsx)(V.Z,{color:"red",text:"Overvis VPN connection is offline.",icon:(0,t.jsx)(g.Z,{}),description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Can't connect to Overvis VPN. Secure remote access is disabled."}),(0,t.jsxs)(d.x,{children:["Contact support (",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"}),") for assistance."]})]}),children:(0,t.jsx)(X.Z,{ok:!1,dest:n.vpnServer,iface:n.interface,error:n.error})}):(0,t.jsx)(V.Z,{color:"green",text:"Overvis VPN connection is online.",icon:(0,t.jsx)(p.Z,{}),children:(0,t.jsx)(r.K,{spacing:"xs",align:"center",children:"unbound"===n.binding.status?(0,t.jsx)(StatusUnbound,{bindLink:n.binding.bindLink,cta:"Bind this device to your Overvis account to have a full remote access from the cloud."}):(0,t.jsx)(StatusBound,{boundAccountEmail:n.binding.boundAccountEmail,openLink:n.binding.openLink})})})}function RcConnectionStatus(e){let{rc:n}=e,s=(0,t.jsxs)(d.x,{children:["Modbus TCP protocol does not support the encryption and is generally slow. To have a fully-featured interface access, VPN connection is preferrable. Please contact"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})," to set up VPN connection on your device."]});return"offline"===n.status?(0,t.jsx)(V.Z,{color:"red",text:"Modbus TCP connection to Overvis cloud is offline.",icon:(0,t.jsx)(g.Z,{}),description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Overvis cloud Modbus TCP server is not accessible or is not accepting the connection from this device."}),(0,t.jsxs)(d.x,{children:["Please contact support (",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"}),") if you require assistance."]})]}),children:(0,t.jsx)(X.Z,{ok:!1,dest:n.ocpServer,iface:n.interface,error:n.lastError,attemptNum:n.attemptNum})}):"unbound"===n.status?(0,t.jsx)(V.Z,{color:"green",text:"Modbus TCP connection to Overvis cloud is online.",icon:(0,t.jsx)(v.Z,{}),description:(0,t.jsxs)(r.K,{spacing:"xs",children:[s,(0,t.jsx)(d.x,{children:"Currently this device is not bound to any account and cannot be accessed by anyone. Binding it to your Overvis account will allow you to manage settings remotely and store the data in the cloud."})]}),children:(0,t.jsx)(StatusUnbound,{bindLink:n.bindLink,cta:"Bind this device to your Overvis account to access it using Modbus TCP protocol.",ac:n.activationCode})}):(0,t.jsx)(V.Z,{color:"green",text:"Modbus TCP connection to Overvis cloud is online.",icon:(0,t.jsx)(v.Z,{}),description:s,children:(0,t.jsx)(StatusBound,{boundAccountEmail:n.boundAccountEmail,openLink:n.openLink})})}function StatusUnbound(e){let{bindLink:n,cta:s,ac:i}=e;return(0,t.jsxs)(r.K,{spacing:"xs",align:"center",children:[(0,t.jsx)(d.x,{align:"center",size:"sm",children:s}),i&&(0,t.jsxs)(r.K,{spacing:0,bg:"green.0",p:"xs",align:"center",children:[(0,t.jsx)(d.x,{weight:"bold",children:"Activation code:"}),(0,t.jsx)(d.x,{size:"lg",weight:"bold",color:"green",children:i})]}),(0,t.jsx)(o.z,{component:"a",href:n,leftIcon:(0,t.jsx)(f.Z,{}),size:"md",color:"blue",children:"Bind"}),(0,t.jsx)(h.e,{href:"https://www.overvis.com/",sx:{textDecoration:"underline"},size:"xs",children:"More about Overvis Cloud..."})]})}function StatusBound(e){let{boundAccountEmail:n,openLink:s}=e,i=(0,C.h)();return(0,t.jsxs)(r.K,{spacing:"xs",align:"center",children:[(0,t.jsxs)(d.x,{align:"center",size:"sm",children:["This device is bound to Overvis account",n?":":"."]}),n&&(0,t.jsx)(d.x,{align:"center",size:"lg",color:"black",lh:"10px",pb:10,weight:"bold",children:n}),i?null:(0,t.jsxs)(x.Z,{position:"center",children:[(0,t.jsx)(o.z,{component:"a",href:s,leftIcon:(0,t.jsx)(v.Z,{}),size:"md",color:"blue",children:"Access from Overvis"}),(0,t.jsx)(o.z,{leftIcon:(0,t.jsx)(b.Z,{}),size:"md",color:"orange",onClick:()=>unbindCloudAccount(),children:"Unbind"})]})]})}var q=s(7860),Q=s(4859),Y=s(7132);function LanSettingsForm(e){let{initialValues:n,onSubmit:s,saving:i}=e,o=(0,B.c)({initialValues:{elan:{...n}},validate:{elan:{...Q.Rx}}});return(0,t.jsx)("form",{onSubmit:o.onSubmit(async e=>{let n=await s(e.elan);n&&o.resetDirty()}),children:(0,t.jsxs)(r.K,{children:[(0,t.jsx)(Y.Z,{form:o}),(0,t.jsx)(M.Z,{type:"submit",inProgress:i,children:"Save"})]})})}function LanStatus(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(H.Z,{icon:(0,t.jsx)(q.Z,{}),name:"LAN",status:n.status,settings:{title:"LAN settings",form:LanSettingsForm,useSettings:Q.rV,save:Q.zQ,onSettingsUpdate:s},children:"connected"===n.status?(0,t.jsx)(Connected,{data:n}):"disconnected"===n.status?(0,t.jsx)(Disconnected,{data:n}):(0,t.jsx)(K.Z,{text:"LAN connection is disabled in settings."})})}function Connected(e){let{data:n}=e;return(0,t.jsxs)(X.Z,{ok:!0,iface:n.interface,children:[(0,t.jsx)(U.Z,{name:"IP/Mask",mainVal:(0,t.jsx)(h.e,{href:"http://".concat(n.ip),target:"_blank",children:n.ip}),subVal:n.mask}),(0,t.jsx)(U.Z,{name:"Gateway",mainVal:n.gatewayIp,subVal:{name:"Ping:",level:(0,w.k)(n.gatewayPingMs),value:"".concat(n.gatewayPingMs,"ms")}})]})}function Disconnected(e){let{data:n}=e;return(0,t.jsx)(X.Z,{ok:!1,text:"Establishing LAN connection...",iface:n.interface,dhcpEnabled:n.dhcpEnabled,error:n.error})}async function mobile_settingsFetcher(e){let[n,s]=e;return{}}function mobile_useSettings(){let e=(0,S.tQ)("mobile-settings",mobile_settingsFetcher);return{...e}}async function mobile_saveSettings(e){}var J=s(8289),$=s(8195);function MobileConnectionSettingsForm(e){let{}=e;return(0,t.jsx)(d.x,{color:"dimmed",size:"sm",children:"Mobile connection is not yet implemented."})}function MobileConnectionStatus(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(H.Z,{icon:(0,t.jsx)(J.Z,{}),name:"GSM/3G/LTE",status:"disabled",settings:{title:"Mobile connection settings",form:MobileConnectionSettingsForm,useSettings:mobile_useSettings,save:mobile_saveSettings,onSettingsUpdate:s},children:(0,t.jsx)(K.Z,{icon:(0,t.jsx)($.Z,{}),text:"Mobile USB modem support is work in progress.",description:"Your device will receive this functionality with an automatic update."})})}var ee=s(2094),en=s(1725),es=s(281),et=s(4080);function WifiSettingsForm(e){let{initialValues:n,onSubmit:s,saving:i}=e,o=(0,B.c)({initialValues:{wlan:{...n}},validate:{wlan:{...es.Rx}}});return(0,t.jsx)("form",{onSubmit:o.onSubmit(async e=>{let n=await s(e.wlan);n&&o.resetDirty()}),children:(0,t.jsxs)(r.K,{children:[(0,t.jsx)(et.Z,{form:o}),(0,t.jsx)(M.Z,{type:"submit",inProgress:i,children:"Save"})]})})}function WifiStatus(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(H.Z,{icon:(0,t.jsx)(en.Z,{}),name:"Wi-Fi",status:"ap"===n.status?"warn":n.status,addEl:"connected"===n.status&&n.strengthDbm?"".concat(n.strengthDbm," dBm"):void 0,settings:{title:"Wi-Fi settings",form:WifiSettingsForm,useSettings:es.rV,save:es.zQ,onSettingsUpdate:s},children:"connected"===n.status?(0,t.jsx)(WifiStatus_Connected,{data:n}):"ap"===n.status?(0,t.jsx)(Ap,{data:n}):"disconnected"===n.status?(0,t.jsx)(WifiStatus_Disconnected,{data:n}):(0,t.jsx)(K.Z,{text:"Wi-Fi connection is disabled in settings."})})}function WifiStatus_Connected(e){let{data:n}=e;return(0,t.jsxs)(X.Z,{ok:!0,dest:n.ssid,iface:n.interface,children:[(0,t.jsx)(U.Z,{name:"IP/Mask",mainVal:(0,t.jsx)(h.e,{href:"http://".concat(n.ip),target:"_blank",children:n.ip}),subVal:n.mask}),(0,t.jsx)(U.Z,{name:"Gateway",mainVal:n.gatewayIp,subVal:{name:"Ping:",level:(0,w.k)(n.gatewayPingMs),value:"".concat(n.gatewayPingMs,"ms")}})]})}function Ap(e){let{data:n}=e;return(0,t.jsxs)(X.Z,{ok:!0,text:"Wi-Fi is in the Access Point mode",iface:n.interface,children:[(0,t.jsx)(U.Z,{name:"SSID",mainVal:n.ssid}),(0,t.jsx)(U.Z,{name:"IP",mainVal:(0,t.jsx)(h.e,{href:"http://".concat(n.ip),target:"_blank",children:n.ip})})]})}function WifiStatus_Disconnected(e){let{data:n}=e;return(0,t.jsx)(X.Z,{ok:!1,text:"Establishing Wi-Fi connection...",iface:n.interface,error:n.error,children:(0,t.jsx)(U.Z,{name:"SSID",mainVal:n.ssid})})}var ei=s(1572);function Page(){let e=(0,ei.ZB)();return e.data?(0,t.jsx)(ee.Z,{pageTitle:"LAN/Internet",children:(0,t.jsxs)(i.r,{children:[(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(LanStatus,{data:e.data.lan,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(WifiStatus,{data:e.data.wifi,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(MobileConnectionStatus,{data:e.data.mobile,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:12,mb:"xl",children:(0,t.jsx)(CloudStatus,{internet:e.data.internet,vpn:e.data.vpn,rc:e.data.rc,updateStatus:e.mutate})})]})}):(0,t.jsx)(ee.Z,{pageTitle:"LAN/Internet",contentIsLoading:!0})}}},function(e){e.O(0,[217,666,161,497,886,703,94,927,774,888,179],function(){return e(e.s=2878)}),_N_E=e.O()}]);