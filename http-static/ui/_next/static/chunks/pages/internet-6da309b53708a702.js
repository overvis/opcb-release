(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[498],{4810:function(e,n,s){"use strict";s.d(n,{Z:function(){return t}});var t=(0,s(2516).Z)("cell-signal-5","IconCellSignal5",[["path",{d:"M20 20h-15.269a.731 .731 0 0 1 -.517 -1.249l14.537 -14.537a.731 .731 0 0 1 1.249 .517v15.269z",key:"svg-0"}],["path",{d:"M16 7v13",key:"svg-1"}],["path",{d:"M12 20v-9",key:"svg-2"}],["path",{d:"M8 20v-5",key:"svg-3"}]])},9533:function(e,n,s){"use strict";s.d(n,{Z:function(){return t}});var t=(0,s(2516).Z)("circle-off","IconCircleOff",[["path",{d:"M20.042 16.045a9 9 0 0 0 -12.087 -12.087m-2.318 1.677a9 9 0 1 0 12.725 12.73",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]])},4348:function(e,n,s){"use strict";s.d(n,{Z:function(){return t}});var t=(0,s(2516).Z)("cloud-upload","IconCloudUpload",[["path",{d:"M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1",key:"svg-0"}],["path",{d:"M9 15l3 -3l3 3",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}]])},7678:function(e,n,s){"use strict";s.d(n,{Z:function(){return t}});var t=(0,s(2516).Z)("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]])},9567:function(e,n,s){"use strict";s.d(n,{Z:function(){return t}});var t=(0,s(2516).Z)("upload","IconUpload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 9l5 -5l5 5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]])},8119:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/internet",function(){return s(532)}])},8486:function(e,n,s){"use strict";s.d(n,{Z:function(){return d}});var t=s(6521),i=s(5988),r=s(9626),o=s(2715),c=s(8349),a=s(3685),l=s(9533);function d(e){let{icon:n,text:s,description:d,children:x,color:u,...h}=e;return(0,t.jsx)(i.M,{h:"100%",p:"xs",...h,children:(0,t.jsxs)(r.K,{p:"sm",spacing:"xs",align:"center",justify:"center",children:[(0,t.jsxs)(o.Z,{spacing:"xs",align:"start",position:"center",children:[(0,t.jsx)(c.k,{color:u||"black",size:"md",variant:"outline",sx:{border:"none"},children:n||(0,t.jsx)(l.Z,{})}),(0,t.jsx)(a.x,{color:u||"black",align:"center",children:s})]}),d&&(0,t.jsx)(a.x,{size:"xs",color:"dimmed",align:"center",children:d}),x]})})}},8944:function(e,n,s){"use strict";s.d(n,{Z:function(){return r}});var t=s(6521),i=s(8486);function r(e){let{error:n,...s}=e;return(0,t.jsx)(i.Z,{...s,p:"xs",bg:"gray.0",color:n?"red":"gray"})}},8146:function(e,n,s){"use strict";s.d(n,{Z:function(){return l}});var t=s(6521),i=s(6360),r=s(9567),o=s(7678),c=s(3071),a=s(9145);function l(e){let{bytes:n,lastBytesSinceSec:s,speed:l,tx:d,oneline:x=!0}=e,u=(0,i.rZ)(),h=void 0!==s&&s<=2?u.colors.green[6]:u.colors.gray[6];return(0,t.jsx)(a.Z,{icon:d?(0,t.jsx)(r.Z,{stroke:1,height:15,color:h}):(0,t.jsx)(o.Z,{stroke:1,height:15,color:h}),name:d?"TX":"RX",nameColor:h,mainVal:(0,c.td)(n),subVal:{level:void 0!==s&&s<=2?"good":"dimmed",value:"".concat((0,c.td)(l),"/s")},oneline:x})}},4153:function(e,n,s){"use strict";s.d(n,{Z:function(){return v}});var t=s(6521),i=s(5721),r=s(5384),o=s(3790),c=s(9626),a=s(2715),l=s(8349),d=s(3685),x=s(7591),u=s(5992),h=s(7663);function p(e){let n="connected"===e.status?"green":"warn"===e.status?"orange":"disconnected"===e.status?"red":"gray";return(0,t.jsx)(o.X,{h:"100%",withBorder:!0,children:(0,t.jsxs)(c.K,{spacing:0,h:"100%",children:[(0,t.jsxs)(a.Z,{position:"apart",align:"center",p:"xs",sx:e=>({borderBottom:"1px solid ".concat(e.colors.gray[3])}),children:[(0,t.jsxs)(a.Z,{spacing:"xs",noWrap:!0,children:[(0,t.jsx)(l.k,{color:n,variant:"light",children:e.icon}),(0,t.jsx)(d.x,{weight:500,c:n,transform:"uppercase",children:e.name}),e.addEl&&"string"==typeof e.addEl?(0,t.jsx)(d.x,{c:"dimmed",size:"sm",children:e.addEl}):e.addEl]}),(0,t.jsxs)(a.Z,{spacing:"xs",noWrap:!0,children:[e.addElRight,e.settingsAction&&(0,t.jsx)(x.A,{color:"blue",onClick:e.settingsAction,children:(0,t.jsx)(h.Z,{size:18})})]})]}),(0,t.jsx)(u.x,{bg:e.bg,h:"100%",children:e.children})]})})}function v(e){let[n,s]=(0,i.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Z,{...e.settings,opened:n,setOpened:s}),(0,t.jsx)(p,{...e,settingsAction:()=>s(!0),children:e.children})]})}},2409:function(e,n,s){"use strict";s.d(n,{Z:function(){return u}});var t=s(6521),i=s(6360),r=s(2715),o=s(4612),c=s(9626),a=s(3685),l=s(4971),d=s(3790),x=s(8342);function u(e){let{iface:n,children:s,dest:u,text:h,error:p,ok:v,dhcpEnabled:m,attemptNum:j}=e,g=(0,i.rZ)();return(0,t.jsxs)(r.Z,{align:"start",spacing:"sm",noWrap:!0,p:"xs",children:[v?(0,t.jsx)(x.Z,{color:g.colors.green[6]}):(0,t.jsx)(o.a,{variant:"dots",mt:9,size:22,color:"dark"}),(0,t.jsxs)(c.K,{spacing:"xs",children:[(0,t.jsxs)(c.K,{spacing:0,children:[(0,t.jsxs)(a.x,{color:v?"green":"dark",children:[h||(v?"Connected":"Connecting"),u&&(0,t.jsxs)(t.Fragment,{children:[" ","to ",(0,t.jsx)("b",{children:u})]}),j&&(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsxs)(a.x,{color:"dimmed",size:"xs",span:!0,children:["(attempt ",j,")"]})]})]}),(0,t.jsxs)(r.Z,{spacing:"sm",children:[(0,t.jsx)(a.x,{color:"dimmed",size:"sm",lh:1,children:n}),void 0!==m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.i,{orientation:"vertical",my:1}),(0,t.jsx)(a.x,{size:"sm",c:"dimmed",lh:1,children:m?"DHCP enabled":"DHCP disabled"})]})]})]}),p&&(0,t.jsx)(a.x,{size:"sm",c:"red",children:p}),s&&(0,t.jsx)(d.X,{bg:"gray.0",p:"xs",ml:"-xs",children:(0,t.jsx)(r.Z,{align:"start",position:"left",children:s})})]})]})}},9145:function(e,n,s){"use strict";s.d(n,{Z:function(){return c}});var t=s(6521),i=s(3685),r=s(2715),o=s(9626);function c(e){let{icon:n,name:s,nameColor:c="dimmed",mainVal:a,subVal:l,oneline:d,valSize:x}=e,u=!function(e){for(var n=arguments.length,s=Array(n>1?n-1:0),t=1;t<n;t++)s[t-1]=arguments[t];return"object"==typeof e&&null!==e&&s.every(n=>n in e)}(l,"value","level")?l:(0,t.jsxs)(t.Fragment,{children:[l.name&&l.name+" ",(0,t.jsx)(i.x,{span:!0,c:"good"===l.level?"green":"medium"===l.level?"orange":"bad"===l.level?"red":"dimmed",transform:"none",children:l.value})]}),h=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.x,{weight:"bold",size:"sm",color:c,transform:"uppercase",children:s}),(0,t.jsx)(i.x,{fz:x||"sm",color:"black",children:a}),u&&(0,t.jsx)(i.x,{size:10,color:"dimmed",children:u})]});return d?(0,t.jsxs)(r.Z,{spacing:5,align:"baseline",noWrap:!0,children:[(0,t.jsx)("div",{style:{position:"relative",top:"2px",marginTop:"-5px",marginRight:"-4px"},children:n}),h]}):(0,t.jsxs)(r.Z,{spacing:0,align:"baseline",noWrap:!0,children:[(0,t.jsx)("div",{style:{position:"relative",top:"2px",marginTop:"-5px"},children:n}),(0,t.jsx)(o.K,{spacing:0,children:h})]})}s(5721)},532:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return e0}});var t=s(6521),i=s(9906),r=s(9400),o=s(9626),c=s(5039),a=s(5992),l=s(4971),d=s(3685),x=s(991),u=s(2715),h=s(7744),p=s(9648),v=s(1569),m=s(9128),j=s(2516),g=(0,j.Z)("world-off","IconWorldOff",[["path",{d:"M3.6 9h5.4m4 0h7.4",key:"svg-0"}],["path",{d:"M5.65 5.623a9 9 0 1 0 12.71 12.745m1.684 -2.328a9 9 0 0 0 -12.094 -12.08",key:"svg-1"}],["path",{d:"M3.6 15h11.4m4 0h1.4",key:"svg-2"}],["path",{d:"M8.335 8.388a19 19 0 0 0 -.335 3.612c0 4.97 1.79 9 4 9c1.622 0 3.018 -2.172 3.646 -5.294m.354 -3.706c0 -4.97 -1.79 -9 -4 -9c-1.035 0 -1.979 .885 -2.689 2.337",key:"svg-3"}],["path",{d:"M3 3l18 18",key:"svg-4"}]]),f=(0,j.Z)("cloud-off","IconCloudOff",[["path",{d:"M3 3l18 18",key:"svg-0"}],["path",{d:"M18 18h-11c-2.598 0 -4.705 -2.015 -4.705 -4.5s2.107 -4.5 4.705 -4.5c.112 -.5 .305 -.973 .568 -1.408m2.094 -1.948c.329 -.174 .68 -.319 1.05 -.43c1.9 -.576 4 -.194 5.5 1c1.503 1.192 2.185 3.017 1.788 4.786h1a3.5 3.5 0 0 1 2.212 6.212",key:"svg-1"}]]),b=s(4348),y=(0,j.Z)("link-off","IconLinkOff",[["path",{d:"M10 14a3.5 3.5 0 0 0 4.47 .444m2.025 -1.94c.557 -.556 1.392 -1.39 2.505 -2.504a3.536 3.536 0 0 0 -5 -5l-.5 .5",key:"svg-0"}],["path",{d:"M9.548 9.544a3.5 3.5 0 0 0 -.548 .456l-4 4a3.536 3.536 0 0 0 5 5l.5 -.5",key:"svg-1"}],["path",{d:"M3 3l18 18",key:"svg-2"}],["path",{d:"M3 3l18 18",key:"svg-3"}]]),Z=s(5721),w=s(3260),P=s(4893),k=s(1904);async function C(e){let[n,s]=e,t=await (0,k.wv)(s,["overvisVpn:isEnabled","overvisVpn:wireguard:ipAddressCidr","overvisReverseConnection:interface","overvisReverseConnection:hostname","overvisReverseConnection:port"]),i={available:!!t["overvisVpn:wireguard:ipAddressCidr"],enabled:"true"===t["overvisVpn:isEnabled"]},r={enabled:!!t["overvisReverseConnection:interface"]&&"disabled"!==t["overvisReverseConnection:interface"],iface:"elan"===t["overvisReverseConnection:interface"]?"elan":"wlan"===t["overvisReverseConnection:interface"]?"wlan":"any",hostname:t["overvisReverseConnection:hostname"]||"",port:parseInt(t["overvisReverseConnection:port"]||"20502",10)};return{vpn:i,rc:r}}function O(){let e=(0,P.tQ)("cloud-settings",C);return{...e}}async function V(e){let n=(0,P.bH)(),s={"overvisVpn:isEnabled":e.vpn.enabled?"true":"false","overvisReverseConnection:interface":e.rc.enabled?e.rc.iface:"disabled"};e.rc.enabled&&(s["overvisReverseConnection:hostname"]=e.rc.hostname,s["overvisReverseConnection:port"]=e.rc.port.toString()),await (0,P.ri)(n,"/api/confs/set/",{method:"POST",body:JSON.stringify(s)})}var S=s(3071),M=s(8486),I=s(6479),z=s(5152),N=s(6215),E=s(7521),T=s(9458),B=s(9994),A=s(6765),K=s(7023),D=s(6485),F=s(9056),R=s(2666),L=s(90);function W(e){let{saving:n,initialValues:s,onSubmit:i}=e,[r,a]=(0,Z.useState)(!1),[l,x]=(0,Z.useState)(!1),{classes:u}=(0,R.Z)(),p=(0,A.c)({initialValues:s,validate:{rc:{hostname:(e,n)=>{if(n.rc.enabled&&!D.C6.test(e))return"Invalid hostname"},port:(0,D.Sg)(e=>e.rc.enabled,(0,K.m)({min:1,max:65535},"Should be in range 1-65535"))}}});return(0,t.jsx)("form",{onSubmit:p.onSubmit(async e=>{let n=await i(e);n&&p.resetDirty()}),children:(0,t.jsxs)(o.K,{children:[(0,t.jsx)(d.x,{color:"dimmed",size:"xs",children:"OPCB supports two kinds of connections to Overvis cloud: VPN and Modbus TCP. VPN should be used if avaliable, as it is more secure, faster and provides a full access to the device from the cloud. VPN access is only available for the devices registered with Overvis. Modbus TCP is a fallback option that provides an access to the OPCB (and connected devices) registers using unsecured Modbus connection."}),(0,t.jsx)(d.x,{color:"dimmed",size:"xs",children:"Both connections can work in parallel, but if VPN connection is enabled, Modbus TCP connection can be safely turned off."}),(0,t.jsxs)(o.K,{spacing:0,children:[(0,t.jsx)(I.D,{order:3,children:"VPN"}),(0,t.jsx)(h.e,{fz:"xs",onClick:()=>a(!r),children:"How it works..."}),(0,t.jsx)(c.U,{in:r,children:(0,t.jsxs)(o.K,{spacing:"xs",children:[(0,t.jsxs)(d.x,{color:"gray.8",size:"xs",children:["During the manufacturing, each OPCB controller is assigned an IP address inside the Overvis VPN network. This VPN is based on WireGuard protocol which is fully encrypted using industry-standard algorhithms (see"," ",(0,t.jsx)(h.e,{href:"https://www.wireguard.com/protocol/",children:"https://www.wireguard.com/protocol/"})," ","for details). If enabled here, the VPN connection is established automatically when the device has internet access."]}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"VPN connection provides the Overvis server with an access to the OPCB API, which allows fast and stable data transfer and also gives the ability to proxy the OPCB web-interface through the cloud."}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"To connect the VPN-enabled device to your Overvis account all you have to do is to provide the PIN code that was assigned to your device during the manufacturing. Using this PIN, Overvis can find your device's IP address inside the VPN. If you need to reassign the device to some other Overvis account, you have to unbind it from the current account first."})]})})]}),p.values.vpn.available?(0,t.jsx)(z.r,{label:"Enable",classNames:{input:p.isDirty("vpn.enabled")&&u.dirtyInput||void 0},checked:p.values.vpn.enabled,...p.getInputProps("vpn.enabled")}):(0,t.jsxs)(d.x,{color:"dimmed",size:"sm",children:["VPN connection is unavailable. Please contact"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})," if you want to register your device."]}),(0,t.jsxs)(o.K,{spacing:0,children:[(0,t.jsx)(I.D,{order:3,children:"Modbus TCP"}),(0,t.jsx)(h.e,{fz:"xs",onClick:()=>x(!l),children:"How it works..."}),(0,t.jsx)(c.U,{in:l,children:(0,t.jsxs)(o.K,{spacing:"xs",children:[(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"Modbus TCP cloud connection acts similar to the OPCB Modbus TCP server, but the connection is established in reverse, e.g. the OPCB server itself connects to the Overvis client. This gives the abitlity to establish the connection even if the device is behind a firewall or NAT. After the connection, OPCB authenticates with its MAC-address and Overvis assigns this OPCB to Overvis account."}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:'If Overvis can\'t find any account that have access to this device, it sends a randomly-generated "Activation Code" value to OPCB. This code is shown in the cloud status panel. By providing this code back to Overvis, you confirm that your account can access this device.'}),(0,t.jsx)(d.x,{color:"gray.8",size:"xs",children:"After the device is assigned to your account, Overvis communicates with OPCB by using standard Modbus TCP protocol. It is not encrypted and relatively slow. It is better to use the VPN connection option if your device is registered with Overvis, i.e. if you have a PIN code."})]})})]}),(0,t.jsx)(z.r,{label:"Enable",classNames:{input:p.isDirty("rc.enabled")&&u.dirtyInput||void 0},checked:p.values.rc.enabled,...p.getInputProps("rc.enabled")}),p.values.rc.enabled&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.Z,{children:(0,t.jsx)(N.Ph,{label:"Interface:",description:"Which network interface to use to establish the connection to Overvis.",data:[{label:"Any",value:"any"},{label:"Ethernet",value:"elan"},{label:"Wi-Fi",value:"wlan"}],classNames:{input:p.isDirty("rc.iface")&&u.dirtyInput||void 0},...p.getInputProps("rc.iface")})}),(0,t.jsxs)(E.M,{cols:2,children:[(0,t.jsx)(L.Z,{children:(0,t.jsx)(T.o,{label:"Hostname:",description:"Hostname of Overvis server to connect to.",required:!0,classNames:{input:p.isDirty("rc.hostname")&&u.dirtyInput||void 0},...p.getInputProps("rc.hostname")})}),(0,t.jsx)(L.Z,{children:(0,t.jsx)(B.Y,{label:"Port:",description:"Port of Overvis server to connect to. Value from 1 to 65535.",required:!0,min:1,max:65535,hideControls:!0,classNames:{input:p.isDirty("rc.port")&&u.dirtyInput||void 0},...p.getInputProps("rc.port")})})]})]}),(0,t.jsx)(F.Z,{type:"submit",inProgress:n,children:"Save"})]})})}var U=s(8944),_=s(5051),H=s(3790),X=s(6360),G=s(3497),q=Object.defineProperty,Q=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,en=(e,n,s)=>n in e?q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,es=(e,n)=>{for(var s in n||(n={}))$.call(n,s)&&en(e,s,n[s]);if(J)for(var s of J(n))ee.call(n,s)&&en(e,s,n[s]);return e},et=(e,n)=>Q(e,Y(n)),ei=(0,G.k)((e,{color:n})=>{let s=n||("dark"===e.colorScheme?"dark":"gray"),t=e.fn.variant({color:s,variant:"light"});return{root:et(es({},e.fn.fontStyles()),{lineHeight:e.lineHeight,padding:`2px calc(${e.spacing.xs}px / 2)`,borderRadius:e.radius.sm,color:"dark"===e.colorScheme?"dark"===s?e.colors.dark[0]:e.white:e.colors.dark[7],backgroundColor:"dark"===e.colorScheme&&"dark"===s?e.colors.dark[5]:t.background,fontFamily:e.fontFamilyMonospace,fontSize:e.fontSizes.xs}),block:{padding:e.spacing.xs,margin:0,overflowX:"auto"}}}),er=Object.defineProperty,eo=Object.getOwnPropertySymbols,ec=Object.prototype.hasOwnProperty,ea=Object.prototype.propertyIsEnumerable,el=(e,n,s)=>n in e?er(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,ed=(e,n)=>{for(var s in n||(n={}))ec.call(n,s)&&el(e,s,n[s]);if(eo)for(var s of eo(n))ea.call(n,s)&&el(e,s,n[s]);return e},ex=(e,n)=>{var s={};for(var t in e)ec.call(e,t)&&0>n.indexOf(t)&&(s[t]=e[t]);if(null!=e&&eo)for(var t of eo(e))0>n.indexOf(t)&&ea.call(e,t)&&(s[t]=e[t]);return s};let eu=(0,Z.forwardRef)((e,n)=>{let s=(0,X.N4)("Code",{},e),{className:t,children:i,block:r,color:o,unstyled:c}=s,l=ex(s,["className","children","block","color","unstyled"]),{classes:d,cx:x}=ei({color:o},{name:"Code",unstyled:c});return r?Z.createElement(a.x,ed({component:"pre",dir:"ltr",className:x(d.root,d.block,t),ref:n},l),i):Z.createElement(a.x,ed({component:"code",className:x(d.root,t),ref:n,dir:"ltr"},l),i)});eu.displayName="@mantine/core/Code";var eh=(0,j.Z)("eye","IconEye",[["path",{d:"M12 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M22 12c-2.667 4.667 -6 7 -10 7s-7.333 -2.333 -10 -7c2.667 -4.667 6 -7 10 -7s7.333 2.333 10 7",key:"svg-1"}]]);function ep(e){let[n,s]=Z.useState(!0);return n?(0,t.jsxs)(eu,{...e,sx:{cursor:"pointer"},onClick:()=>s(!1),children:[(0,t.jsx)(eh,{size:"10px",style:{position:"relative",top:"1px"}})," Show"]}):(0,t.jsx)(eu,{...e})}var ev=s(9145);function em(e){let{hasRegistration:n,pin:s,mac:i,publicKey:r,privateKey:c,model:a,assignedVpnIp:x}=e;return(0,t.jsxs)(o.K,{spacing:"xs",pt:13,children:[(0,t.jsx)(d.x,{align:"center",color:"gray.5",size:"md",transform:"uppercase",weight:500,pb:"1px",children:"Registration"}),(0,t.jsx)(l.i,{color:"gray.4"}),n?(0,t.jsxs)(o.K,{children:[(0,t.jsx)(u.Z,{position:"center",children:(0,t.jsx)("a",{href:"/media/opcb-label.png",target:"_blank",children:(0,t.jsx)(_.E,{src:"/media/opcb-label.png",alt:"OPCB VPN information label.",width:"100",height:"100",maw:"260px"})})}),(0,t.jsx)(H.X,{bg:"gray.2",p:"xs",children:(0,t.jsxs)(o.K,{align:"left",spacing:"xs",children:[(0,t.jsxs)(u.Z,{children:[(0,t.jsx)(ev.Z,{name:"PIN",mainVal:(0,t.jsx)(eu,{children:s})}),(0,t.jsx)(ev.Z,{name:"MAC",mainVal:(0,t.jsx)(eu,{children:i})}),(0,t.jsx)(ev.Z,{name:"Assigned IP",mainVal:(0,t.jsx)(eu,{children:x})})]}),(0,t.jsx)(ev.Z,{name:"Wireguard VPN Keys",mainVal:(0,t.jsxs)(o.K,{mt:3,spacing:3,children:[(0,t.jsxs)(u.Z,{align:"baseline",spacing:0,children:[(0,t.jsx)(d.x,{fz:"xs",color:"dimmed",miw:50,children:"Public:"}),(0,t.jsx)(eu,{color:"dimmed",fz:"10px",children:r})]}),(0,t.jsxs)(u.Z,{align:"baseline",spacing:0,children:[(0,t.jsx)(d.x,{fz:"xs",color:"dimmed",miw:50,children:"Private:"}),(0,t.jsx)(ep,{color:"dimmed",fz:"10px",children:c})]})]})})]})})]}):(0,t.jsxs)(o.K,{children:[(0,t.jsxs)(o.K,{spacing:4,children:[(0,t.jsx)(d.x,{ta:"center",color:"orange",children:"This device is not registered in Overvis cloud."}),(0,t.jsx)(d.x,{ta:"center",size:"sm",color:"dimmed",children:"You can still connect it to the cloud using Modbus, but you are missing the ability to securely access OPCB interface from the internet."}),(0,t.jsx)(d.x,{ta:"center",size:"sm",children:"Please contact us if you wish to acquire a registration:"}),(0,t.jsx)(h.e,{size:"sm",ta:"center",href:"mailto:support@overvis.com",children:"support@overvis.com"})]}),(0,t.jsx)(l.i,{color:"gray.4"}),(0,t.jsxs)(u.Z,{align:"start",position:"left",children:[(0,t.jsx)(ev.Z,{name:"MODEL",mainVal:(0,t.jsx)(eu,{children:a})}),(0,t.jsx)(ev.Z,{name:"MAC",mainVal:(0,t.jsx)(eu,{children:i})}),(0,t.jsx)(ev.Z,{name:"PUBKEY",mainVal:(0,t.jsx)(eu,{fz:"11px",children:r})})]})]})]})}var ej=s(8146),eg=s(4153),ef=s(2409);function eb(e){let{internet:n,vpn:s,rc:l,updateStatus:d}=e,[x,u]=(0,Z.useState)(!1),h="online"===s.connection.status||"online"===l.status?"connected":"offline"===s.connection.status&&"offline"===l.status?"disconnected":"disabled";return(0,t.jsxs)(i.r,{children:[(0,t.jsx)(i.r.Col,{md:8,children:(0,t.jsx)(eg.Z,{icon:"online"===s.connection.status?(0,t.jsx)(p.Z,{}):(0,t.jsx)(v.Z,{}),name:"Overvis Cloud",status:h,settings:{size:700,title:"Overvis Cloud connection settings",form:W,useSettings:O,save:V,onSettingsUpdate:d},addEl:(0,t.jsx)(r.z,{variant:"subtle",compact:!0,size:"xs",radius:"xl",styles:{leftIcon:{marginRight:4}},py:2,leftIcon:(0,t.jsx)(m.Z,{size:14}),onClick:()=>u(!x),children:x?"Hide details":"Show details"}),children:(0,t.jsxs)(o.K,{h:"100%",spacing:0,children:[(0,t.jsx)(c.U,{in:x,children:(0,t.jsx)(ey,{rc:l,vpn:s})}),(0,t.jsx)(a.x,{style:{flex:1},children:(0,t.jsx)(eP,{internet:n,vpn:s,rc:l})})]})})}),(0,t.jsx)(i.r.Col,{md:4,children:(0,t.jsx)(em,{hasRegistration:"unregistered"!==s.connection.status,pin:s.pin,mac:s.mac,privateKey:s.privateKey,publicKey:s.publicKey,model:s.model,assignedVpnIp:s.assignedVpnIp})})]})}function ey(e){let{rc:n,vpn:s}=e;return(0,t.jsx)(a.x,{p:"xs",bg:"gray.1",sx:e=>({borderBottom:"1px solid ".concat(e.colors.gray[3])}),children:(0,t.jsxs)(o.K,{spacing:"xs",children:[(0,t.jsx)(eZ,{vpn:s.connection}),(0,t.jsx)(l.i,{color:"gray.3",mx:"-xs"}),(0,t.jsx)(ew,{rc:n})]})})}function eZ(e){let{vpn:n}=e,s=n.status,[i,r]="online"===s?["Connected","green"]:"offline"===s?["Disconnected","red"]:"disabled"===s?["Disabled","gray"]:["Unregistered","dimmed"];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.x,{fz:"sm",tt:"uppercase",fw:"bold",children:["VPN"," ",(0,t.jsx)(x.C,{color:r,size:"xs",children:i})]}),"disabled"!==n.status&&"unregistered"!==n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(ev.Z,{name:"Interface",mainVal:n.interface,oneline:!0}),(0,t.jsx)(ev.Z,{name:"VPN IP",mainVal:n.ip,oneline:!0}),"online"===n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ev.Z,{name:"RX",mainVal:(0,S.td)(n.rxtx.rxTotalBytes),oneline:!0}),(0,t.jsx)(ev.Z,{name:"TX",mainVal:(0,S.td)(n.rxtx.txTotalBytes),oneline:!0})]})]}),(0,t.jsxs)(u.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(ev.Z,{name:"Endpoint",mainVal:n.vpnServer,oneline:!0}),(0,t.jsx)(ev.Z,{name:"Endpoint VPN IP",mainVal:n.serverInternalIp,oneline:!0}),(0,t.jsx)(ev.Z,{name:"Endpoint Key",mainVal:n.serverPublicKey,oneline:!0})]})]})]})}function ew(e){let{rc:n}=e,s=n.status,[i,r]="online"===s||"unbound"===s?["Connected","green"]:"offline"===s?["Disconnected","red"]:["Disabled","gray"];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.x,{fz:"sm",tt:"uppercase",fw:"bold",children:["Modbus TCP"," ",(0,t.jsx)(x.C,{color:r,size:"xs",children:i})]}),"disabled"!==n.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.Z,{sx:{rowGap:"2px"},children:[(0,t.jsx)(ev.Z,{name:"Interface",mainVal:n.interface,oneline:!0}),(0,t.jsx)(ev.Z,{name:"Overvis Server",mainVal:n.ocpServer,oneline:!0}),(0,t.jsx)(ev.Z,{name:"Own MAC",mainVal:n.mac,oneline:!0}),"offline"===n.status&&n.lastConnectionOn&&(0,t.jsx)(ev.Z,{name:"Last connection on",mainVal:(0,w.o0)(n.lastConnectionOn),oneline:!0})]}),("online"===n.status||"unbound"===n.status)&&(0,t.jsxs)(u.Z,{sx:{rowGap:"2px"},align:"start",children:[(0,t.jsx)(ev.Z,{name:"Connected for",mainVal:(0,S.Ch)(n.connectedSec),oneline:!0}),(0,t.jsx)(ej.Z,{bytes:n.rxtx.rxConnectionBytes,speed:n.rxtx.rxSpeedBytesPerSec,lastBytesSinceSec:n.rxtx.rxLastBytesSinceSec}),(0,t.jsx)(ej.Z,{bytes:n.rxtx.txConnectionBytes,speed:n.rxtx.txSpeedBytesPerSec,lastBytesSinceSec:n.rxtx.txLastBytesSinceSec,tx:!0})]})]})]})}function eP(e){let{internet:n,vpn:s,rc:i}=e,r=s.connection;return"disabled"===n.status?(0,t.jsx)(U.Z,{icon:(0,t.jsx)(g,{}),text:"Internet access is disabled for this device.",description:"This device is unreachable from the internet, only LAN access is enabled. All cloud functionality is disabled."}):"offline"===n.status?(0,t.jsx)(U.Z,{icon:(0,t.jsx)(g,{}),text:"Device is offline.",error:!0,description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Set up the internet connection to access this device from Overvis Cloud."}),(0,t.jsxs)(d.x,{children:["Consult ",(0,t.jsx)(h.e,{href:"https://docs.overvis.com/#/OPCB/",children:"documentation"})," or contact support:"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})]})]})}):"unregistered"===r.status?"disabled"===i.status?(0,t.jsx)(U.Z,{icon:(0,t.jsx)(f,{}),text:"Modbus TCP connection to Overvis cloud is disabled for this device.",description:"Device has internet access but is not attempting to connect to the cloud."}):(0,t.jsx)(eO,{rc:i}):"disabled"===r.status&&"disabled"===i.status?(0,t.jsx)(U.Z,{icon:(0,t.jsx)(f,{}),text:"VPN connection to Overvis cloud is disabled for this device.",description:(0,t.jsx)(ek,{rcDisabled:!0})}):"disabled"===i.status||"online"===r.status?(0,t.jsx)(eC,{vpn:r}):(0,t.jsxs)(o.K,{spacing:0,children:[(0,t.jsx)(eC,{vpn:r}),(0,t.jsx)(l.i,{variant:"dotted"}),(0,t.jsx)(eO,{rc:i})]})}function ek(e){let{rcDisabled:n}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"This device is registered in Overvis Cloud but VPN access is disabled in the device settings."}),n?(0,t.jsx)(d.x,{children:"Modbus TCP connection is disabled too."}):(0,t.jsx)(d.x,{children:"Modbus TCP connection is enabled, but it doesn't provide a secure remote access to device interface."}),(0,t.jsx)(d.x,{color:"black",children:"Enable VPN to access this device from the cloud securely."})]})}function eC(e){let{vpn:n}=e;return"disabled"===n.status?(0,t.jsx)(M.Z,{color:"gray",text:"Overvis VPN connection is disabled.",icon:(0,t.jsx)(f,{}),description:(0,t.jsx)(ek,{})}):"offline"===n.status?(0,t.jsx)(M.Z,{color:"red",text:"Overvis VPN connection is offline.",icon:(0,t.jsx)(f,{}),description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Can't connect to Overvis VPN. Secure remote access is disabled."}),(0,t.jsxs)(d.x,{children:["Contact support (",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"}),") for assistance."]})]}),children:(0,t.jsx)(ef.Z,{ok:!1,dest:n.vpnServer,iface:n.interface,error:n.error})}):(0,t.jsx)(M.Z,{color:"green",text:"Overvis VPN connection is online.",icon:(0,t.jsx)(p.Z,{}),children:(0,t.jsx)(o.K,{spacing:"xs",align:"center",children:"unbound"===n.binding.status?(0,t.jsx)(eV,{bindLink:n.binding.bindLink,cta:"Bind this device to your Overvis account to have a full remote access from the cloud."}):(0,t.jsx)(eS,{boundAccountEmail:n.binding.boundAccountEmail,openLink:n.binding.openLink})})})}function eO(e){let{rc:n}=e,s=(0,t.jsxs)(d.x,{children:["Modbus TCP protocol does not support the encryption and is generally slow. To have a fully-featured interface access, VPN connection is preferrable. Please contact"," ",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"})," to set up VPN connection on your device."]});return"offline"===n.status?(0,t.jsx)(M.Z,{color:"red",text:"Modbus TCP connection to Overvis cloud is offline.",icon:(0,t.jsx)(f,{}),description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.x,{children:"Overvis cloud Modbus TCP server is not accessible or is not accepting the connection from this device."}),(0,t.jsxs)(d.x,{children:["Please contact support (",(0,t.jsx)(h.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"}),") if you require assistance."]})]}),children:(0,t.jsx)(ef.Z,{ok:!1,dest:n.ocpServer,iface:n.interface,error:n.lastError,attemptNum:n.attemptNum})}):"unbound"===n.status?(0,t.jsx)(M.Z,{color:"green",text:"Modbus TCP connection to Overvis cloud is online.",icon:(0,t.jsx)(v.Z,{}),description:(0,t.jsxs)(o.K,{spacing:"xs",children:[s,(0,t.jsx)(d.x,{children:"Currently this device is not bound to any account and cannot be accessed by anyone. Binding it to your Overvis account will allow you to manage settings remotely and store the data in the cloud."})]}),children:(0,t.jsx)(eV,{bindLink:n.bindLink,cta:"Bind this device to your Overvis account to access it using Modbus TCP protocol.",ac:n.activationCode})}):(0,t.jsx)(M.Z,{color:"green",text:"Modbus TCP connection to Overvis cloud is online.",icon:(0,t.jsx)(v.Z,{}),description:s,children:(0,t.jsx)(eS,{boundAccountEmail:n.boundAccountEmail,openLink:n.openLink})})}function eV(e){let{bindLink:n,cta:s,ac:i}=e;return(0,t.jsxs)(o.K,{spacing:"xs",align:"center",children:[(0,t.jsx)(d.x,{align:"center",size:"sm",children:s}),i&&(0,t.jsxs)(o.K,{spacing:0,bg:"green.0",p:"xs",align:"center",children:[(0,t.jsx)(d.x,{weight:"bold",children:"Activation code:"}),(0,t.jsx)(d.x,{size:"lg",weight:"bold",color:"green",children:i})]}),(0,t.jsx)(r.z,{component:"a",href:n,leftIcon:(0,t.jsx)(b.Z,{}),size:"md",color:"blue",children:"Bind"}),(0,t.jsx)(h.e,{href:"https://www.overvis.com/",sx:{textDecoration:"underline"},size:"xs",children:"More about Overvis Cloud..."})]})}function eS(e){let{boundAccountEmail:n,openLink:s}=e;return(0,t.jsxs)(o.K,{spacing:"xs",align:"center",children:[(0,t.jsxs)(d.x,{align:"center",size:"sm",children:["This device is bound to Overvis account",n?":":"."]}),n&&(0,t.jsx)(d.x,{align:"center",size:"lg",color:"black",lh:"10px",pb:10,weight:"bold",children:n}),(0,t.jsxs)(u.Z,{position:"center",children:[(0,t.jsx)(r.z,{component:"a",href:s,leftIcon:(0,t.jsx)(v.Z,{}),size:"md",color:"blue",children:"Access from Overvis"}),(0,t.jsx)(r.z,{leftIcon:(0,t.jsx)(y,{}),size:"md",color:"orange",children:"Unbind"})]})]})}var eM=s(1508),eI=s(482),ez=s(706);function eN(e){let{initialValues:n,onSubmit:s,saving:i}=e,r=(0,A.c)({initialValues:{elan:{...n}},validate:{elan:{...eI.Rx}}});return(0,t.jsx)("form",{onSubmit:r.onSubmit(async e=>{let n=await s(e.elan);n&&r.resetDirty()}),children:(0,t.jsxs)(o.K,{children:[(0,t.jsx)(ez.Z,{form:r}),(0,t.jsx)(F.Z,{type:"submit",inProgress:i,children:"Save"})]})})}function eE(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(eg.Z,{icon:(0,t.jsx)(eM.Z,{}),name:"LAN",status:n.status,settings:{title:"LAN settings",form:eN,useSettings:eI.rV,save:eI.zQ,onSettingsUpdate:s},children:"connected"===n.status?(0,t.jsx)(eT,{data:n}):"disconnected"===n.status?(0,t.jsx)(eB,{data:n}):(0,t.jsx)(U.Z,{text:"LAN connection is disabled in settings."})})}function eT(e){let{data:n}=e;return(0,t.jsxs)(ef.Z,{ok:!0,iface:n.interface,children:[(0,t.jsx)(ev.Z,{name:"IP/Mask",mainVal:n.ip,subVal:n.mask}),(0,t.jsx)(ev.Z,{name:"Gateway",mainVal:n.gatewayIp,subVal:{name:"Ping:",level:(0,S.k)(n.gatewayPingMs),value:"".concat(n.gatewayPingMs,"ms")}})]})}function eB(e){let{data:n}=e;return(0,t.jsx)(ef.Z,{ok:!1,text:"Establishing LAN connection...",iface:n.interface,dhcpEnabled:n.dhcpEnabled,error:n.error})}async function eA(e){let[n,s]=e;return{}}function eK(){let e=(0,P.tQ)("mobile-settings",eA);return{...e}}async function eD(e){}var eF=s(4810),eR=(0,j.Z)("cell-signal-off","IconCellSignalOff",[["path",{d:"M20 20h-15.269a.731 .731 0 0 1 -.517 -1.249l7.265 -7.264m2 -2l5.272 -5.272a.731 .731 0 0 1 1.249 .517v11.269",key:"svg-0"}],["path",{d:"M3 3l18 18",key:"svg-1"}]]);function eL(e){let{}=e;return(0,t.jsx)(d.x,{color:"dimmed",size:"sm",children:"Mobile connection is not yet implemented."})}function eW(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(eg.Z,{icon:(0,t.jsx)(eF.Z,{}),name:"GSM/3G/LTE",status:"disabled",settings:{title:"Mobile connection settings",form:eL,useSettings:eK,save:eD,onSettingsUpdate:s},children:(0,t.jsx)(U.Z,{icon:(0,t.jsx)(eR,{}),text:"Mobile USB modem support is work in progress.",description:"Your device will receive this functionality with an automatic update."})})}var eU=s(9266),e_=s(8394),eH=s(5766),eX=s(4908);function eG(e){let{initialValues:n,onSubmit:s,saving:i}=e,r=(0,A.c)({initialValues:{wlan:{...n}},validate:{wlan:{...eH.Rx}}});return(0,t.jsx)("form",{onSubmit:r.onSubmit(async e=>{!r.isDirty("ap.password")&&r.values.wlan.ap.password&&(e.wlan.ap.password=eH.Ak),!r.isDirty("client.password")&&r.values.wlan.client.password&&(e.wlan.client.password=eH.Ak);let n=await s(e.wlan);n&&r.resetDirty()}),children:(0,t.jsxs)(o.K,{children:[(0,t.jsx)(eX.Z,{form:r}),(0,t.jsx)(F.Z,{type:"submit",inProgress:i,children:"Save"})]})})}function eq(e){let{data:n,updateStatus:s}=e;return(0,t.jsx)(eg.Z,{icon:(0,t.jsx)(e_.Z,{}),name:"Wi-Fi",status:"ap"===n.status?"warn":n.status,addEl:"connected"===n.status&&n.strengthDbm?"".concat(n.strengthDbm," dBm"):void 0,settings:{title:"Wi-Fi settings",form:eG,useSettings:eH.rV,save:eH.zQ,onSettingsUpdate:s},children:"connected"===n.status?(0,t.jsx)(eQ,{data:n}):"ap"===n.status?(0,t.jsx)(eY,{data:n}):"disconnected"===n.status?(0,t.jsx)(eJ,{data:n}):(0,t.jsx)(U.Z,{text:"Wi-Fi connection is disabled in settings."})})}function eQ(e){let{data:n}=e;return(0,t.jsxs)(ef.Z,{ok:!0,dest:n.ssid,iface:n.interface,children:[(0,t.jsx)(ev.Z,{name:"IP/Mask",mainVal:n.ip,subVal:n.mask}),(0,t.jsx)(ev.Z,{name:"Gateway",mainVal:n.gatewayIp,subVal:{name:"Ping:",level:(0,S.k)(n.gatewayPingMs),value:"".concat(n.gatewayPingMs,"ms")}})]})}function eY(e){let{data:n}=e;return(0,t.jsxs)(ef.Z,{ok:!0,text:"Wi-Fi is in the Access Point mode",iface:n.interface,children:[(0,t.jsx)(ev.Z,{name:"SSID",mainVal:n.ssid}),(0,t.jsx)(ev.Z,{name:"IP",mainVal:n.ip,subVal:(0,t.jsx)("a",{href:n.url,style:{color:"inherit"},children:n.url})})]})}function eJ(e){let{data:n}=e;return(0,t.jsx)(ef.Z,{ok:!1,text:"Establishing Wi-Fi connection...",iface:n.interface,error:n.error,children:(0,t.jsx)(ev.Z,{name:"SSID",mainVal:n.ssid})})}var e$=s(9111);function e0(){let e=(0,e$.ZB)();return e.data?(0,t.jsx)(eU.Z,{pageTitle:"LAN/Internet",children:(0,t.jsxs)(i.r,{children:[(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(eE,{data:e.data.lan,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(eq,{data:e.data.wifi,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:4,mb:"xl",children:(0,t.jsx)(eW,{data:e.data.mobile,updateStatus:e.mutate})}),(0,t.jsx)(i.r.Col,{xs:12,mb:"xl",children:(0,t.jsx)(eb,{internet:e.data.internet,vpn:e.data.vpn,rc:e.data.rc,updateStatus:e.mutate})})]})}):(0,t.jsx)(eU.Z,{pageTitle:"LAN/Internet",contentIsLoading:!0})}}},function(e){e.O(0,[473,13,953,167,266,810,774,888,179],function(){return e(e.s=8119)}),_N_E=e.O()}]);