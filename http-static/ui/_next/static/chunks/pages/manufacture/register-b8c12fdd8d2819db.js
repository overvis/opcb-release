(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{5790:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manufacture/register",function(){return r(2697)}])},8435:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var i=r(6521),n=r(3497),s=r(8481),a=r(6007),c=r(4432),o=r(8236),u=r(3765),l=r(1863),d=r(2996),h=r(7280),f=r(9266);let g=(0,n.k)(e=>({tabsList:{borderBottom:"1px solid ".concat(e.colors.gray[4])},tab:{color:e.colors.blue[6],textTransform:"uppercase",fontSize:e.fontSizes.xs,"&:hover":{backgroundColor:"transparent",border:"transparent",color:e.colors.dark},"&[data-active]":{borderBottom:"2px solid #000",pointerEvents:"none"}}}));function v(e){let{children:t,title:r,id:n,wireguardConnected:v,internetConnected:p}=e,{classes:m}=g(),b=(0,h.useRouter)();return(0,i.jsxs)(f.Z,{pageTitle:"Manufacture :: ".concat(r),children:[("restore"===n||"register"===n)&&(0,i.jsxs)(i.Fragment,{children:[v&&(0,i.jsx)(s.b,{my:"lg",icon:(0,i.jsx)(c.Z,{}),title:"Already authenticated.",color:"yellow",children:"This device is already authenticated on the remote server and has an access. By submitting this form you may lose the access or change the device's identity."}),!p&&(0,i.jsx)(s.b,{my:"lg",icon:(0,i.jsx)(c.Z,{}),title:"No internet access.",color:"yellow",children:"Active internet connection is required to restore the device's identity. Please check the device's settings."})]}),(0,i.jsxs)(a.m,{color:"dark",value:n,variant:"default",classNames:{tabsList:m.tabsList,tab:m.tab},onTabChange:e=>b.push("/manufacture/".concat(e)),children:[(0,i.jsxs)(a.m.List,{mb:"lg",children:[(0,i.jsx)(a.m.Tab,{value:"restore",icon:(0,i.jsx)(o.Z,{size:16}),children:"Restore identity"}),(0,i.jsx)(a.m.Tab,{value:"register",icon:(0,i.jsx)(u.Z,{size:16}),children:"Register"}),(0,i.jsx)(a.m.Tab,{value:"test",icon:(0,i.jsx)(l.Z,{size:16}),children:"Test"}),(0,i.jsx)(a.m.Tab,{value:"finalize",icon:(0,i.jsx)(d.Z,{size:16}),children:"Finalize"})]}),(0,i.jsx)(a.m.Panel,{value:n,children:t})]})]})}},7845:function(e,t,r){"use strict";r.d(t,{H:function(){return a}});var i=r(4893),n=r(1904);async function s(e){let[t,r]=e,i=await (0,n.UK)(r,["wg:ping","wg:pubkey","inet:ping","overvisRc:mac","manufacturer:modeEnabled","manufacturer:licenseUuid","manufacturer:licensePassword","manufacturer:batchDescription"]),s=await (0,n.wv)(r,["overvisVpn:wireguard:privateKey"]),a={internetConnected:!1,wireguardConnected:!1,pubkey:i["wg:pubkey"],mac:i["overvisRc:mac"],manufacturerModeEnabled:Boolean(i["manufacturer:modeEnabled"]),licenseUuid:i["manufacturer:licenseUuid"],licensePassword:i["manufacturer:licensePassword"],batchDescription:i["manufacturer:batchDescription"],privateKey:s["overvisVpn:wireguard:privateKey"]},c=i["inet:ping"];c&&"unreachable"!==c&&(a.wireguardConnected=!0);let o=i["inet:ping"];return o&&"unreachable"!==o&&(a.internetConnected=!0),a}function a(){return(0,i.tQ)("manufacturer-status",s)}},2697:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var i=r(6521),n=r(9626),s=r(3685),a=r(7744),c=r(2715),o=r(9458),u=r(293),l=r(109),d=r(9400),h=r(6765),f=r(4091),g=r(8435),v=r(9266),p=r(4893),m=r(7845);function b(){let e=(0,m.H)();if(!e.data)return(0,i.jsx)(v.Z,{pageTitle:"LAN/Internet",contentIsLoading:!0});let t=e.data;return(0,i.jsx)(g.Z,{id:"register",title:"Register device",internetConnected:t.internetConnected,wireguardConnected:t.wireguardConnected,children:(0,i.jsx)(x,{licenseUuid:t.licenseUuid,licensePassword:t.licensePassword,batchDescription:t.batchDescription,privateKey:e.data.privateKey})})}function x(e){let{actionHandler:t}=(0,f.vu)(),r=(0,h.c)({initialValues:e}),g=async()=>{let e=(0,p.bH)(),t=await (0,p.ri)(e,"/api/manufacture/register/",{method:"POST",body:JSON.stringify(r.values)});if((null==t?void 0:t.status)!==200)throw Error("request failed with status "+(null==t?void 0:t.status))};return(0,i.jsxs)(n.K,{h:"100%",children:[(0,i.jsxs)(s.x,{fz:"xs",c:"gray",children:["This form is for registering a new device on the remote Overvis servers. It requires manufacturer license to work. If you don't have a manufacturer license but want to register the device, please contact us:"," ",(0,i.jsx)(a.e,{href:"mailto:support@overvis.com",children:"support@overvis.com"}),"."]}),(0,i.jsx)("form",{onSubmit:r.onSubmit(()=>{t({actionProcess:g,title:"Registering OPCB",failedTitle:"Regiter failed.",failedId:"register-failed",startActionText:"Sending the data to the server...",afterActionText:"Registering the device...",successId:"register-success",successTitle:"OPCB has been registered.",successMessage:"Register the device, completed successfully."})}),children:(0,i.jsxs)(n.K,{h:"100%",children:[(0,i.jsxs)(c.Z,{grow:!0,children:[(0,i.jsx)(o.o,{label:"Manufacturer license key ID:",...r.getInputProps("licenseUuid"),required:!0}),(0,i.jsx)(u.W,{label:"Manufacturer license key password:",...r.getInputProps("licensePassword"),required:!0})]}),(0,i.jsx)(c.Z,{grow:!0,children:(0,i.jsx)(o.o,{label:"Device private key:",...r.getInputProps("privateKey"),required:!0})}),(0,i.jsx)(l.g,{label:"Additional comments (optional, will be saved on the server):",...r.getInputProps("batchDescription")}),(0,i.jsx)(c.Z,{children:(0,i.jsx)(d.z,{type:"submit",children:"Registration"})})]})})]})}}},function(e){e.O(0,[473,13,7,151,266,774,888,179],function(){return e(e.s=5790)}),_N_E=e.O()}]);