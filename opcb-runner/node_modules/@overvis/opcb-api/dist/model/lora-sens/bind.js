"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.bindDevice = void 0;
const sku_1 = require("./sku");
function bindDevice(queries, did, devKindCode, firmwareVersion, frequencyDeviceKhz, frequencyGatewayKhz, bandwidthKhz, spreadFactor, codingRateBits) {
    const sku = (0, sku_1.deductLoraSku)(devKindCode);
    const deviceId = queries.transaction(() => {
        // insert into table devices new device
        const deviceId = queries.device.insert({
            title: (0, sku_1.getDefaultSkuTitle)(sku),
            origTemplateId: sku,
            channel: `LGW:${did}`,
        });
        // insert into table lorasens_devices new lorasens device
        queries.loraSens.insertDevice({
            deviceId,
            did,
            sku,
            deviceKindCode: devKindCode,
            firmwareVersion,
            password: Math.floor(Math.random() * 100000000)
                .toString()
                .padStart(8, "0"),
            updatePeriodSec: 300,
            activeModeTill: 0,
            frequencyDeviceKhz,
            frequencyGatewayKhz,
            bandwidthKhz,
            spreadingFactor: spreadFactor,
            codingRateBits,
        });
        return deviceId;
    })();
    return deviceId;
}
exports.bindDevice = bindDevice;
//# sourceMappingURL=bind.js.map