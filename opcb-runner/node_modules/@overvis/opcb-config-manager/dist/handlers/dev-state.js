"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createDevStateHandler = void 0;
const __1 = require("..");
const setconf_1 = require("../setconf");
function createDevStateHandler(bus, state, validate, configFile) {
    return async () => {
        const versionFromState = (await bus.getState(["release:version"]))["release:version"];
        if (!versionFromState || versionFromState === state.config.global.lastRunVersion) {
            return;
        }
        __1.logger.info(`Saving current version (${versionFromState}) as last ran version in config file.`);
        const _res = await (0, setconf_1.setConfig)({
            bus,
            state,
            values: { "global:lastRunVersion": versionFromState },
            validate,
            configFile,
            context: "config",
        });
        await bus.setState({ "release:lastSuccessfulUpgradeRef": versionFromState });
    };
}
exports.createDevStateHandler = createDevStateHandler;
//# sourceMappingURL=dev-state.js.map