"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.updateDiskSpaceUsage = void 0;
const exec_1 = require("../exec");
async function updateDiskSpaceUsage() {
    const df = await (0, exec_1.exec)("df", ["/"], "silent");
    const lines = df
        .trim()
        .split("\n")
        .map((s) => s.trim());
    if (lines.length < 2) {
        throw new Error(`"df /" returned unexpected output: ${df}`);
    }
    const [_header, line] = lines;
    const [_fs, size, used, _avail, _use, mount] = line.split(/\s+/);
    if (mount !== "/") {
        throw new Error(`"df /" returned unexpected output: ${df}`);
    }
    return {
        "storage:total": parseInt(size, 10) * 1024,
        "storage:used": parseInt(used, 10) * 1024,
    };
}
exports.updateDiskSpaceUsage = updateDiskSpaceUsage;
//# sourceMappingURL=disk.js.map