"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTasksProjectVersion = void 0;
const tslib_1 = require("tslib");
const fs = tslib_1.__importStar(require("fs"));
const _1 = require(".");
function getTasksProjectVersion(tasksProjectDir) {
    let packageContent;
    try {
        packageContent = fs.readFileSync(`${tasksProjectDir}/package.json`, "utf8");
    }
    catch (err) {
        if (err && typeof err === "object" && "code" in err && err.code === "ENOENT") {
            return undefined;
        }
        throw err;
    }
    let parsed;
    try {
        parsed = JSON.parse(packageContent);
    }
    catch (err) {
        _1.logger.error(err, `Failed to parse ${tasksProjectDir}/package.json`);
        return undefined;
    }
    if (!parsed || !(typeof parsed === "object")) {
        _1.logger.error(`Invalid format of ${tasksProjectDir}/package.json`);
        return undefined;
    }
    if (!("version" in parsed) ||
        !(typeof parsed.version === "string")) {
        _1.logger.error(`No 'version' property in ${tasksProjectDir}/package.json`);
        return undefined;
    }
    return parsed.version;
}
exports.getTasksProjectVersion = getTasksProjectVersion;
//# sourceMappingURL=tasks.js.map