"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SingleBgRunner = void 0;
class SingleBgRunner {
    constructor(runJob, onError) {
        this.runJob = runJob;
        this.onError = onError;
        this.isRunning = false;
    }
    async runAsync(...args) {
        if (this.isRunning) {
            this.queueRunArgs = args;
            return;
        }
        this.isRunning = true;
        try {
            await this.runJob(...args);
        }
        catch (err) {
            this.onError(err);
        }
        finally {
            this.isRunning = false;
        }
        if (this.queueRunArgs) {
            await this.runAsync(...this.queueRunArgs);
            this.queueRunArgs = undefined;
        }
    }
    run(...args) {
        this.runAsync(...args).catch(() => null);
    }
}
exports.SingleBgRunner = SingleBgRunner;
//# sourceMappingURL=utils.js.map