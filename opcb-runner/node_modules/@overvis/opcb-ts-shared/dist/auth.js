"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkIfPasswordIsCorrect = exports.encryptPassword = void 0;
var tslib_1 = require("tslib");
var crypto = tslib_1.__importStar(require("crypto"));
function encryptPassword(password) {
    var algo = "sha256";
    var salt = crypto.randomBytes(8).toString("base64");
    var hash = crypto
        .createHash(algo)
        .update(password + salt)
        .digest("base64");
    return "".concat(algo, "$").concat(salt, "$").concat(hash);
}
exports.encryptPassword = encryptPassword;
function checkIfPasswordIsCorrect(providedPassword, hashedPassword) {
    var _a = hashedPassword.split("$"), algo = _a[0], salt = _a[1], hash = _a[2];
    var providedHash = crypto
        .createHash(algo)
        .update(providedPassword + salt)
        .digest("base64");
    return providedHash === hash;
}
exports.checkIfPasswordIsCorrect = checkIfPasswordIsCorrect;
//# sourceMappingURL=auth.js.map