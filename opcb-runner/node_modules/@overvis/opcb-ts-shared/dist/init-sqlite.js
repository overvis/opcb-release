"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var fs = tslib_1.__importStar(require("fs"));
var sqlite_1 = require("./sqlite");
function run() {
    var userDir = process.argv[2] || ".";
    var opcbDb = userDir + "/opcb.sqlite3";
    try {
        fs.unlinkSync(opcbDb);
    }
    catch (_a) { }
    (0, sqlite_1.migrateDb)(opcbDb, console);
    var opcbMemDb = userDir + "/opcb-mem.sqlite3";
    try {
        fs.unlinkSync(opcbMemDb);
    }
    catch (_b) { }
    (0, sqlite_1.initMemDb)(opcbMemDb);
    var fixture = process.argv[3] || "dev";
    var dbFixtureFile = "./sqlite-fixtures/".concat(fixture, "/opcb.sql");
    var dbFixture = fs.readFileSync(dbFixtureFile, "utf-8");
    var db = (0, sqlite_1.connectSqlite)(opcbDb);
    db.exec(dbFixture);
    var memDbFixtureFile = "./sqlite-fixtures/".concat(fixture, "/opcb-mem.sql");
    var memDbFixture = fs.readFileSync(memDbFixtureFile, "utf-8");
    var memDb = (0, sqlite_1.connectSqlite)(opcbMemDb);
    memDb.exec(memDbFixture);
}
run();
//# sourceMappingURL=init-sqlite.js.map