create table lorasens_unbinded_devices (
    did integer primary key,
    old_did integer not null, -- only for ui information / warning
    created_on integer not null,
    bind_started_on integer, -- only for ui spinner
    blacklisted_on integer,
    rx_last_on integer not null,
    rx_signal integer not null,
    device_kind_code integer not null,
    firmware_version integer not null,
    frequency_device_khz integer not null, -- 864000 / 864025 / 864050 ... 869200
    frequency_gateway_khz integer not null, -- 864000 / 864025 / 864050 ... 869200
    bandwidth_khz text not null, -- 7.6 /10.4 /15.6 /20.8 /31.25 /41.7 /62.5 /125 /250 /500
    spreading_factor integer not null, -- 6 <= spreading_factor <= 12
    coding_rate_bits integer not null, -- 5 <= coding_rate <= 8
    -- password integer not null,
    packets_lost integer default 0 not null
);

create table lorasens_device_statuses (
    did integer not null,
    next_connection_expected_on integer,
    device_time_sec integer,
    power_level_percent integer,
    records_space_usage_percent integer,
    rx_total_bytes integer default 0 not null,
    rx_speed_bps integer default 0 not null,
    rx_last_on integer,
    rx_signal_dbm integer,
    tx_total_bytes integer default 0 not null,
    tx_speed_bps integer default 0 not null,
    tx_last_on integer,
    tx_signal_dbm integer,
    packets_lost integer default 0 not null
);

create table task_runs (
    id uuid default (uuid()) primary key,
    task_id uuid not null,
    started_on integer not null,
    log text,
    finished_on integer,
    error text,
    user_json text
);

create table task_files (
    filepath text primary key, -- path without file extension relative to user tasks project dir
    last_updated_on integer not null,
    task_name text,
    task_description text
);

create table param_last_results (
    device_id text not null,
    param_id text not null,
    resulted_on integer not null,
    value text,
    error text,

    primary key (device_id, param_id)
);
